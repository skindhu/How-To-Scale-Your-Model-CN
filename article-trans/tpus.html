<!DOCTYPE html>

<html class="" data-theme="light" data-theme-setting="system" lang="zh-CN">
<head><link href="https://giscus.app/default.css" id="giscus-css" rel="stylesheet"/><style>#back-to-top{background:#000;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;bottom:20px;-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);-moz-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);box-shadow:0 2px 5px 0 rgba(0,0,0,.26);color:#fff;cursor:pointer;display:block;height:56px;opacity:1;outline:0;position:fixed;right:20px;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-transition:bottom .2s,opacity .2s;-o-transition:bottom .2s,opacity .2s;-moz-transition:bottom .2s,opacity .2s;transition:bottom .2s,opacity .2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:56px;z-index:1}#back-to-top svg{display:block;fill:currentColor;height:20px;margin:11px auto 0;width:20px}#back-to-top.hidden{bottom:-56px;opacity:0}</style> <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/> <meta charset="utf-8"/> <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/> <meta content="IE=edge" http-equiv="X-UA-Compatible"/> <title>å¦‚ä½•ç†è§£ TPU | å¦‚ä½•æ‰©å±•æ‚¨çš„æ¨¡å‹</title> <meta content=" " name="author"/> <meta content="æœ¬èŠ‚å°†æ·±å…¥æ¢è®¨ TPU çš„å·¥ä½œåŸç†ã€å®ƒä»¬å¦‚ä½•é€šè¿‡ç½‘ç»œäº’è¿ä»¥å®ç°å¤šèŠ¯ç‰‡è®­ç»ƒå’Œæ¨ç†ï¼Œä»¥åŠè¿™ç§æ¶æ„å¯¹æˆ‘ä»¬å¸¸ç”¨ç®—æ³•æ€§èƒ½çš„å½±å“ã€‚æ­¤å¤–ï¼Œæœ¬èŠ‚å†…å®¹å¯¹ GPU ç”¨æˆ·ä¹Ÿå¤§æœ‰è£¨ç›Šï¼" name="description"/> <meta content="scaling, jax, llms, transformers, tpus, google, deepmind, parallelism, pallas" name="keywords"/> <link href="https://jax-ml.github.io/scaling-book/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04" rel="stylesheet"/> <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" rel="stylesheet"/> <link defer="" href="https://jax-ml.github.io/scaling-book/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5" rel="stylesheet"/> <link defer="" href="https://jax-ml.github.io/scaling-book/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772" rel="stylesheet"/> <link defer="" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap" rel="stylesheet" type="text/css"/> <link defer="" href="https://jax-ml.github.io/scaling-book/assets/css/jekyll-pygments-themes-vs.css?4ee1a2facd1a8a76347f4bd43a740500" id="highlight_theme_light" media="" rel="stylesheet"/> <link href="https://jax-ml.github.io/scaling-book/assets/img/favicon.png?fddbd8c2ec231ba2060e67c85de32a55" rel="shortcut icon"/> <link href="https://jax-ml.github.io/scaling-book/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e" rel="stylesheet"/> <link href="tpus.html" rel="canonical"/> <style id="distill-prerendered-styles" type="text/css">/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

html {
  font-size: 14px;
	line-height: 1.6em;
  /* font-family: "Libre Franklin", "Helvetica Neue", sans-serif; */
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  /*, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";*/
  text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}

@media(min-width: 768px) {
  html {
    font-size: 16px;
  }
}

body {
  margin: 0;
}

a {
  color: #004276;
}

figure {
  margin: 0;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}

table th {
	text-align: left;
}

table thead {
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

table thead th {
  padding-bottom: 0.5em;
}

table tbody :first-child td {
  padding-top: 0.5em;
}

pre {
  overflow: auto;
  max-width: 100%;
}

p {
  margin-top: 0;
  margin-bottom: 1em;
}

sup, sub {
  vertical-align: baseline;
  position: relative;
  top: -0.4em;
  line-height: 1em;
}

sub {
  top: 0.4em;
}

.kicker,
.marker {
  font-size: 15px;
  font-weight: 600;
  color: rgba(0, 0, 0, 0.5);
}


/* Headline */

@media(min-width: 1024px) {
  d-title h1 span {
    display: block;
  }
}

/* Figure */

figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

figcaption+figure {

}

figure img {
  width: 100%;
}

figure svg text,
figure svg tspan {
}

figcaption,
.figcaption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

@media(min-width: 1024px) {
figcaption,
.figcaption {
    font-size: 13px;
  }
}

figure.external img {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

figcaption a {
  color: rgba(0, 0, 0, 0.6);
}

figcaption b,
figcaption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@supports not (display: grid) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    display: block;
    padding: 8px;
  }
}

.base-grid,
distill-header,
d-title,
d-abstract,
d-article,
d-appendix,
distill-appendix,
d-byline,
d-footnote-list,
d-citation-list,
distill-footer {
  display: grid;
  justify-items: stretch;
  grid-template-columns: [screen-start] 8px [page-start kicker-start text-start gutter-start middle-start] 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr [text-end page-end gutter-end kicker-end middle-end] 8px [screen-end];
  grid-column-gap: 8px;
}

.grid {
  display: grid;
  grid-column-gap: 8px;
}

@media(min-width: 768px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start middle-start text-start] 45px 45px 45px 45px 45px 45px 45px 45px [ kicker-end text-end gutter-start] 45px [middle-end] 45px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }
}

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 50px [middle-start] 50px [text-start kicker-end] 50px 50px 50px 50px 50px 50px 50px 50px [text-end gutter-start] 50px [middle-end] 50px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}




.base-grid {
  grid-column: screen;
}

/* .l-body,
d-article > *  {
  grid-column: text;
}

.l-page,
d-title > *,
d-figure {
  grid-column: page;
} */

.l-gutter {
  grid-column: gutter;
}

.l-text,
.l-body {
  grid-column: text;
}

.l-page {
  grid-column: page;
}

.l-body-outset {
  grid-column: middle;
}

.l-page-outset {
  grid-column: page;
}

.l-screen {
  grid-column: screen;
}

.l-screen-inset {
  grid-column: screen;
  padding-left: 16px;
  padding-left: 16px;
}


/* Aside */

d-article aside {
  grid-column: gutter;
  font-size: 12px;
  line-height: 1.6em;
  color: rgba(0, 0, 0, 0.6)
}

@media(min-width: 768px) {
  aside {
    grid-column: gutter;
  }

  .side {
    grid-column: gutter;
  }
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

d-title {
  padding: 2rem 0 1.5rem;
  contain: layout style;
  overflow-x: hidden;
}

@media(min-width: 768px) {
  d-title {
    padding: 4rem 0 1.5rem;
  }
}

d-title h1 {
  grid-column: text;
  font-size: 40px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

@media(min-width: 768px) {
  d-title h1 {
    font-size: 50px;
  }
}

d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  grid-column: text;
}

d-title .status {
  margin-top: 0px;
  font-size: 12px;
  color: #009688;
  opacity: 0.8;
  grid-column: kicker;
}

d-title .status span {
  line-height: 1;
  display: inline-block;
  padding: 6px 0;
  border-bottom: 1px solid #80cbc4;
  font-size: 11px;
  text-transform: uppercase;
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

d-byline {
  contain: style;
  overflow: hidden;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  font-size: 0.8rem;
  line-height: 1.8em;
  padding: 1.5rem 0;
  min-height: 1.8em;
}


d-byline .byline {
  grid-template-columns: 1fr 1fr;
  grid-column: text;
}

@media(min-width: 768px) {
  d-byline .byline {
    grid-template-columns: 1fr 1fr 1fr 1fr;
  }
}

d-byline .authors-affiliations {
  grid-column-end: span 3;
  grid-template-columns: 1fr 1fr 1fr;
  margin-bottom: 1em;
}

@media(min-width: 768px) {
  d-byline .authors-affiliations {
    margin-bottom: 0;
  }
}

d-byline h3 {
  font-size: 0.6rem;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  margin: 0;
  text-transform: uppercase;
}

d-byline p {
  margin: 0;
}

d-byline a,
d-article d-byline a {
  color: rgba(0, 0, 0, 0.8);
  text-decoration: none;
  border-bottom: none;
}

d-article d-byline a:hover {
  text-decoration: underline;
  border-bottom: none;
}

d-byline p.author {
  font-weight: 500;
}

d-byline .affiliations {

}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

d-article {
  contain: layout style;
 border-top: 1px solid rgba(0, 0, 0, 0.1);
  padding-top: 2rem;
  color: rgba(0, 0, 0, 0.8);
}

d-article > * {
  grid-column: text;
}

@media(min-width: 768px) {
  d-article {
    font-size: 16px;
  }
}

@media(min-width: 1024px) {
  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
}


/* H2 */


d-article .marker {
  text-decoration: none;
  border: none;
  counter-reset: section;
  grid-column: kicker;
  line-height: 1.7em;
}

d-article .marker:hover {
  border: none;
}

d-article .marker span {
  padding: 0 3px 4px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  position: relative;
  top: 4px;
}

d-article .marker:hover span {
  color: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid rgba(0, 0, 0, 0.7);
}

d-article h2 {
  font-weight: 600;
  font-size: 24px;
  line-height: 1.25em;
  margin: 2rem 0 1.5rem 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: 1rem;
}

@media(min-width: 1024px) {
  d-article h2 {
    font-size: 36px;
  }
}

/* H3 */

d-article h3 {
  font-weight: 700;
  font-size: 18px;
  line-height: 1.4em;
  margin-bottom: 1em;
  margin-top: 2em;
}

@media(min-width: 1024px) {
  d-article h3 {
    font-size: 20px;
  }
}

/* H4 */

d-article h4 {
  font-weight: 600;
  text-transform: uppercase;
  font-size: 14px;
  line-height: 1.4em;
}

d-article a {
  color: inherit;
}

d-article p,
d-article ul,
d-article ol,
d-article blockquote {
  margin-top: 0;
  margin-bottom: 1em;
  margin-left: 0;
  margin-right: 0;
}

d-article blockquote {
  border-left: 2px solid rgba(0, 0, 0, 0.2);
  padding-left: 2em;
  font-style: italic;
  color: rgba(0, 0, 0, 0.6);
}

d-article a {
  border-bottom: 1px solid var(--global-underline-color);
  text-decoration: none;
}

d-article a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.8);
}

d-article .link {
  text-decoration: underline;
  cursor: pointer;
}

d-article ul,
d-article ol {
  padding-left: 24px;
}

d-article li {
  margin-bottom: 1em;
  margin-left: 0;
  padding-left: 0;
}

d-article li:last-child {
  margin-bottom: 0;
}

d-article pre {
  font-size: 14px;
  margin-bottom: 20px;
}

d-article hr {
  grid-column: screen;
  width: 100%;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  margin-top: 60px;
  margin-bottom: 60px;
}

d-article section {
  margin-top: 60px;
  margin-bottom: 60px;
}

d-article span.equation-mimic {
  font-family: georgia;
  font-size: 115%;
  font-style: italic;
}

d-article > d-code,
d-article section > d-code  {
  display: block;
}

d-article > d-math[block],
d-article section > d-math[block]  {
  display: block;
}

@media (max-width: 768px) {
  d-article > d-code,
  d-article section > d-code,
  d-article > d-math[block],
  d-article section > d-math[block] {
      overflow-x: scroll;
      -ms-overflow-style: none;  // IE 10+
      overflow: -moz-scrollbars-none;  // Firefox
  }

  d-article > d-code::-webkit-scrollbar,
  d-article section > d-code::-webkit-scrollbar,
  d-article > d-math[block]::-webkit-scrollbar,
  d-article section > d-math[block]::-webkit-scrollbar {
    display: none;  // Safari and Chrome
  }
}

d-article .citation {
  color: #668;
  cursor: pointer;
}

d-include {
  width: auto;
  display: block;
}

d-figure {
  contain: layout style;
}

/* KaTeX */

.katex, .katex-prerendered {
  contain: style;
  display: inline-block;
}

/* Tables */

d-article table {
  border-collapse: collapse;
  margin-bottom: 1.5rem;
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

d-article table th {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

d-article table td {
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

d-article table tr:last-of-type td {
  border-bottom: none;
}

d-article table th,
d-article table td {
  font-size: 15px;
  padding: 2px 8px;
}

d-article table tbody :first-child td {
  padding-top: 2px;
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

span.katex-display {
  text-align: left;
  padding: 8px 0 8px 0;
  margin: 0.5em 0 0.5em 1em;
}

span.katex {
  -webkit-font-smoothing: antialiased;
;
  font-size: 1.18em;
}

/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@media print {

  @page {
    size: 8in 11in;
    @bottom-right {
      content: counter(page) " of " counter(pages);
    }
  }

  html {
    /* no general margins -- CSS Grid takes care of those */
  }

  p, code {
    page-break-inside: avoid;
  }

  h2, h3 {
    page-break-after: avoid;
  }

  d-header {
    visibility: hidden;
  }

  d-footer {
    display: none!important;
  }

}
</style><script src="https://jax-ml.github.io/scaling-book/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer="" href="https://jax-ml.github.io/scaling-book/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" id="highlight_theme_dark" media="none" rel="stylesheet"/> <script>
    initTheme();
  </script> <script src="https://jax-ml.github.io/scaling-book/assets/js/distillpub/template.v2.js"></script> <script src="https://jax-ml.github.io/scaling-book/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">{{page._styles}}</style> <style type="text/css">/* Chart.js */
@-webkit-keyframes chartjs-render-animation{from{opacity:0.99}to{opacity:1}}@keyframes chartjs-render-animation{from{opacity:0.99}to{opacity:1}}.chartjs-render-monitor{-webkit-animation:chartjs-render-animation 0.001s;animation:chartjs-render-animation 0.001s;}</style><style type="text/css">.medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}</style><style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
  text-align: left;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

_::-webkit-full-page-media, _:future, :root mjx-container {
  will-change: opacity;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-math {
  display: inline-block;
  text-align: left;
  line-height: 0;
  text-indent: 0;
  font-style: normal;
  font-weight: normal;
  font-size: 100%;
  font-size-adjust: none;
  letter-spacing: normal;
  border-collapse: collapse;
  word-wrap: normal;
  word-spacing: normal;
  white-space: nowrap;
  direction: ltr;
  padding: 1px 0;
}

mjx-container[jax="CHTML"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="CHTML"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="CHTML"][display="true"] mjx-math {
  padding: 0;
}

mjx-container[jax="CHTML"][justify="left"] {
  text-align: left;
}

mjx-container[jax="CHTML"][justify="right"] {
  text-align: right;
}

mjx-mfrac {
  display: inline-block;
  text-align: left;
}

mjx-frac {
  display: inline-block;
  vertical-align: 0.17em;
  padding: 0 .22em;
}

mjx-frac[type="d"] {
  vertical-align: .04em;
}

mjx-frac[delims] {
  padding: 0 .1em;
}

mjx-frac[atop] {
  padding: 0 .12em;
}

mjx-frac[atop][delims] {
  padding: 0;
}

mjx-dtable {
  display: inline-table;
  width: 100%;
}

mjx-dtable > * {
  font-size: 2000%;
}

mjx-dbox {
  display: block;
  font-size: 5%;
}

mjx-num {
  display: block;
  text-align: center;
}

mjx-den {
  display: block;
  text-align: center;
}

mjx-mfrac[bevelled] > mjx-num {
  display: inline-block;
}

mjx-mfrac[bevelled] > mjx-den {
  display: inline-block;
}

mjx-den[align="right"], mjx-num[align="right"] {
  text-align: right;
}

mjx-den[align="left"], mjx-num[align="left"] {
  text-align: left;
}

mjx-nstrut {
  display: inline-block;
  height: .054em;
  width: 0;
  vertical-align: -.054em;
}

mjx-nstrut[type="d"] {
  height: .217em;
  vertical-align: -.217em;
}

mjx-dstrut {
  display: inline-block;
  height: .505em;
  width: 0;
}

mjx-dstrut[type="d"] {
  height: .726em;
}

mjx-line {
  display: block;
  box-sizing: border-box;
  min-height: 1px;
  height: .06em;
  border-top: .06em solid;
  margin: .06em -.1em;
  overflow: hidden;
}

mjx-line[type="d"] {
  margin: .18em -.1em;
}

mjx-mrow {
  display: inline-block;
  text-align: left;
}

mjx-mn {
  display: inline-block;
  text-align: left;
}

mjx-c {
  display: inline-block;
}

mjx-utext {
  display: inline-block;
  padding: .75em 0 .2em 0;
}

mjx-mi {
  display: inline-block;
  text-align: left;
}

mjx-msup {
  display: inline-block;
  text-align: left;
}

mjx-mo {
  display: inline-block;
  text-align: left;
}

mjx-stretchy-h {
  display: inline-table;
  width: 100%;
}

mjx-stretchy-h > * {
  display: table-cell;
  width: 0;
}

mjx-stretchy-h > * > mjx-c {
  display: inline-block;
  transform: scalex(1.0000001);
}

mjx-stretchy-h > * > mjx-c::before {
  display: inline-block;
  width: initial;
}

mjx-stretchy-h > mjx-ext {
  /* IE */ overflow: hidden;
  /* others */ overflow: clip visible;
  width: 100%;
}

mjx-stretchy-h > mjx-ext > mjx-c::before {
  transform: scalex(500);
}

mjx-stretchy-h > mjx-ext > mjx-c {
  width: 0;
}

mjx-stretchy-h > mjx-beg > mjx-c {
  margin-right: -.1em;
}

mjx-stretchy-h > mjx-end > mjx-c {
  margin-left: -.1em;
}

mjx-stretchy-v {
  display: inline-block;
}

mjx-stretchy-v > * {
  display: block;
}

mjx-stretchy-v > mjx-beg {
  height: 0;
}

mjx-stretchy-v > mjx-end > mjx-c {
  display: block;
}

mjx-stretchy-v > * > mjx-c {
  transform: scaley(1.0000001);
  transform-origin: left center;
  overflow: hidden;
}

mjx-stretchy-v > mjx-ext {
  display: block;
  height: 100%;
  box-sizing: border-box;
  border: 0px solid transparent;
  /* IE */ overflow: hidden;
  /* others */ overflow: visible clip;
}

mjx-stretchy-v > mjx-ext > mjx-c::before {
  width: initial;
  box-sizing: border-box;
}

mjx-stretchy-v > mjx-ext > mjx-c {
  transform: scaleY(500) translateY(.075em);
  overflow: visible;
}

mjx-mark {
  display: inline-block;
  height: 0px;
}

mjx-msub {
  display: inline-block;
  text-align: left;
}

mjx-TeXAtom {
  display: inline-block;
  text-align: left;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}

mjx-c.mjx-c38::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "8";
}

mjx-c.mjx-c1D435.TEX-I::before {
  padding: 0.683em 0.759em 0 0;
  content: "B";
}

mjx-c.mjx-c1D437.TEX-I::before {
  padding: 0.683em 0.828em 0 0;
  content: "D";
}

mjx-c.mjx-c32::before {
  padding: 0.666em 0.5em 0 0;
  content: "2";
}

mjx-c.mjx-c39::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "9";
}

mjx-c.mjx-c2E::before {
  padding: 0.12em 0.278em 0 0;
  content: ".";
}

mjx-c.mjx-c1D452.TEX-I::before {
  padding: 0.442em 0.466em 0.011em 0;
  content: "e";
}

mjx-c.mjx-c31::before {
  padding: 0.666em 0.5em 0 0;
  content: "1";
}

mjx-c.mjx-c34::before {
  padding: 0.677em 0.5em 0 0;
  content: "4";
}

mjx-c.mjx-c3E::before {
  padding: 0.54em 0.778em 0.04em 0;
  content: ">";
}

mjx-c.mjx-c35::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "5";
}

mjx-c.mjx-c30::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "0";
}

mjx-c.mjx-c2243::before {
  padding: 0.464em 0.778em 0 0;
  content: "\2243";
}

mjx-c.mjx-c36::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "6";
}

mjx-c.mjx-c2C::before {
  padding: 0.121em 0.278em 0.194em 0;
  content: ",";
}

mjx-c.mjx-c6D::before {
  padding: 0.442em 0.833em 0 0;
  content: "m";
}

mjx-c.mjx-c61::before {
  padding: 0.448em 0.5em 0.011em 0;
  content: "a";
}

mjx-c.mjx-c78::before {
  padding: 0.431em 0.528em 0 0;
  content: "x";
}

mjx-c.mjx-c7B::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "{";
}

mjx-c.mjx-c1D447.TEX-I::before {
  padding: 0.677em 0.704em 0 0;
  content: "T";
}

mjx-c.mjx-c74::before {
  padding: 0.615em 0.389em 0.01em 0;
  content: "t";
}

mjx-c.mjx-c68::before {
  padding: 0.694em 0.556em 0 0;
  content: "h";
}

mjx-c.mjx-c63::before {
  padding: 0.448em 0.444em 0.011em 0;
  content: "c";
}

mjx-c.mjx-c6F::before {
  padding: 0.448em 0.5em 0.01em 0;
  content: "o";
}

mjx-c.mjx-c73::before {
  padding: 0.448em 0.394em 0.011em 0;
  content: "s";
}

mjx-c.mjx-c7D::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "}";
}

mjx-c.mjx-c3D::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "=";
}

mjx-c.mjx-c7B.TEX-S3::before {
  padding: 1.45em 0.75em 0.949em 0;
  content: "{";
}

mjx-c.mjx-c37::before {
  padding: 0.676em 0.5em 0.022em 0;
  content: "7";
}

mjx-c.mjx-c2B::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "+";
}

mjx-c.mjx-c22C5::before {
  padding: 0.31em 0.278em 0 0;
  content: "\22C5";
}

mjx-c.mjx-c33::before {
  padding: 0.665em 0.5em 0.022em 0;
  content: "3";
}

mjx-c.mjx-c7D.TEX-S3::before {
  padding: 1.45em 0.75em 0.949em 0;
  content: "}";
}

mjx-c.mjx-c1D439.TEX-I::before {
  padding: 0.68em 0.749em 0 0;
  content: "F";
}
</style><link crossorigin="anonymous" href="https://distill.pub/third-party/katex/katex.min.css" rel="stylesheet"/><script async="" src="https://distill.pub/third-party/katex/katex.min.js"></script></head>
<body> <d-front-matter> <script async="" type="text/json">
      {
            "title": "å¦‚ä½•ç†è§£TPU",
            "description": "æœ¬èŠ‚å°†å…¨é¢ä»‹ç»TPUçš„å·¥ä½œåŸç†ã€å®ƒä»¬å¦‚ä½•é€šè¿‡ç½‘ç»œè¿æ¥ä»¥æ”¯æŒå¤šèŠ¯ç‰‡è®­ç»ƒå’Œæ¨ç†ï¼Œä»¥åŠè¿™äº›å› ç´ å¦‚ä½•å½±å“æˆ‘ä»¬å¸¸ç”¨ç®—æ³•çš„æ€§èƒ½ã€‚å…¶ä¸­ä¹Ÿæœ‰ä¸€äº›å†…å®¹å¯¹GPUç”¨æˆ·åŒæ ·é€‚ç”¨ï¼",
            "published": "February 04, 2025",
            "authors": [

              {
                "author": "Jacob Austin",
                "authorURL": "https://www.jacobaustin.org/",
                "affiliations": [
                  {
                    "name": "Google DeepMind",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Sholto Douglas",
                "authorURL": "https://x.com/_sholtodouglas",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Roy Frostig",
                "authorURL": "https://cs.stanford.edu/~rfrostig/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Anselm Levskaya",
                "authorURL": "https://anselmlevskaya.com/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Charlie Chen",
                "authorURL": "https://x.com/charliexychen",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Sharad Vikram",
                "authorURL": "https://sharadvikram.com/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Federico Lebron",
                "authorURL": "https://fedelebron.com/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Peter Choy",
                "authorURL": "https://x.com/pchoy95",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Vinay Ramasesh",
                "authorURL": "https://x.com/vinayramasesh",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Albert Webson",
                "authorURL": "https://representation.ai/",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              },

              {
                "author": "Reiner Pope<sup>*</sup>",
                "authorURL": "https://x.com/reinerpope",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              }

            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <script>
    function goToTop() {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    }

    // When the user scrolls down 20px from the top of the document, show the button
    window.onscroll = function() {scrollFunction()};

    function scrollFunction() {
      // Get the button:
      let mybutton = document.getElementById("top-button");

      if (document.body.scrollTop > 40 || document.documentElement.scrollTop > 40) {
        mybutton.style.display = "block";
      } else {
        mybutton.style.display = "none";
      }
  }
  </script> <nav class="navbar navbar-light navbar-expand-sm fixed-top" id="navbar" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="scaling-book.html"> å¦‚ä½•æ‰©å±•ä½ çš„æ¨¡å‹ </a> <button aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler collapsed ml-auto" data-target="#navbarNav" data-toggle="collapse" type="button"> <span class="sr-only">åˆ‡æ¢å¯¼èˆª</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="left-button section-button"><a href="roofline.html"><svg viewbox="-78.5 0 512 512"><path d="M257 64L291 98 128 262 291 426 257 460 61 262 257 64Z"></path></svg></a></div> <div class="right-button section-button"><a href="sharding.html"><svg viewbox="-78.5 0 512 512"><path d="M98 460L64 426 227 262 64 98 98 64 294 262 98 460Z"></path></svg></a></div> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item"> <a class="nav-link" href="scaling-book.html"> </a> </li> <li class="nav-item nav-hidden"><a class="nav-link" id="top-button" onclick="goToTop()" style="display: none;">è¿”å›é¡¶éƒ¨</a></li> <li class="nav-item nav-hidden"><p class="nav-link"></p></li> <li class="nav-item nav-hidden"><a class="nav-link" href="roofline.html">ä¸Šä¸€éƒ¨åˆ†</a></li> <li class="nav-item nav-hidden"><a class="nav-link" href="sharding.html">ä¸‹ä¸€éƒ¨åˆ†</a></li> <li class="nav-item nav-hidden"><p class="nav-link"></p></li> <li class="nav-item dropdown"> <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" id="navbarDropdown" role="button">ç« èŠ‚ </a> <div aria-labelledby="navbarDropdown" class="dropdown-menu dropdown-menu-right"> <a class="dropdown-item" href="https://jax-ml.github.io/scaling-book/index">ç¬¬0éƒ¨åˆ†. å¼•è¨€</a> <a class="dropdown-item" href="roofline.html">ç¬¬1éƒ¨åˆ†. Rooflineæ¨¡å‹å…¥é—¨</a> <a class="dropdown-item" href="tpus.html">ç¬¬2éƒ¨åˆ†. å…¨é¢äº†è§£TPU</a> <a class="dropdown-item" href="sharding.html">ç¬¬3éƒ¨åˆ†. åˆ†ç‰‡çŸ©é˜µä¹˜æ³•</a> <a class="dropdown-item" href="transformers.html">ç¬¬4éƒ¨åˆ†. Transformer</a> <a class="dropdown-item" href="training.html">ç¬¬5éƒ¨åˆ†. è®­ç»ƒ</a> <a class="dropdown-item" href="applied-training.html">ç¬¬6éƒ¨åˆ†. è®­ç»ƒLLaMA</a> <a class="dropdown-item" href="inference.html">ç¬¬7éƒ¨åˆ†. æ¨ç†</a> <a class="dropdown-item" href="applied-inference.html">ç¬¬8éƒ¨åˆ†. éƒ¨ç½²LLaMA</a> <a class="dropdown-item" href="profiling.html">ç¬¬9éƒ¨åˆ†. æ€§èƒ½åˆ†æ</a> <a class="dropdown-item" href="jax-stuff.html">ç¬¬10éƒ¨åˆ†. å…¨é¢äº†è§£JAX</a> <a class="dropdown-item" href="conclusion.html">ç¬¬11éƒ¨åˆ†. ç»“è®º</a> <a class="dropdown-item" href="gpus.html">ç¬¬12éƒ¨åˆ†. GPU</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"><div class="translation-info base-grid" style="margin-bottom: 20px;">
<div style="grid-column: text;
                       display: flex;
                       align-items: center;
                       justify-content: space-between;
                       padding: 16px 0;
                       border-bottom: 1px solid var(--global-text-color-light, rgba(0,0,0,0.15));
                       font-size: 16px;
                       line-height: 1.5;
                       color: var(--global-text-color, currentColor);">
<div style="display: flex;
                           flex-direction: column;
                           gap: 8px;">
<div>
<span style="font-weight: 600; color: var(--global-text-color, currentColor);">ğŸ”— è‹±æ–‡åŸæ–‡ï¼š</span>
<a href="https://jax-ml.github.io/scaling-book/tpus/" onmouseout="this.style.textDecoration='none'" onmouseover="this.style.textDecoration='underline'" rel="noopener noreferrer" style="color: var(--global-theme-color, #004276);
                                  text-decoration: none;
                                  margin-left: 4px;" target="_blank">
                           https://jax-ml.github.io/scaling-book/tpus/
                        </a>
</div>
<div>
<span style="font-weight: 600; color: var(--global-text-color, currentColor);">âœï¸ ç¿»è¯‘ï¼š</span>
<a href="https://github.com/skindhu/How-To-Scale-Your-Model-CN" target="_blank" style="margin-left: 4px; color: var(--global-theme-color, #004276); text-decoration: none;">åŒ—æçš„æ ‘</a>
</div>
</div>
<div style="flex-shrink: 0;
                           display: flex;
                           flex-direction: column;
                           align-items: center;
                           gap: 6px;
                           margin-left: 20px;">
<img alt="å¾®ä¿¡äºŒç»´ç " loading="lazy" src="https://wechat-account-1251781786.cos.ap-guangzhou.myqcloud.com/wechat_account.jpeg" style="width: 80px;
                                height: 80px;
                                border-radius: 6px;
                                opacity: 0.9;"/>
<span style="font-size: 12px;
                                 color: var(--global-text-color-light, currentColor);
                                 opacity: 0.8;
                                 text-align: center;">
                        å¾®ä¿¡å…¬ä¼—å·
                    </span>
</div>
</div>
</div> <d-title> <h1>å¦‚ä½•ç†è§£TPU</h1> <p>ã€Šå¦‚ä½•æ‰©å±•ä½ çš„æ¨¡å‹ã€‹ç¬¬2éƒ¨åˆ† (<a href="roofline.html">ç¬¬1éƒ¨åˆ†ï¼šRooflineæ¨¡å‹</a> | <a href="sharding.html">ç¬¬3éƒ¨åˆ†ï¼šåˆ†ç‰‡</a>)</p> <p>æœ¬èŠ‚å°†å…¨é¢ä»‹ç»TPUçš„å·¥ä½œåŸç†ã€å®ƒä»¬å¦‚ä½•é€šè¿‡ç½‘ç»œè¿æ¥ä»¥æ”¯æŒå¤šèŠ¯ç‰‡è®­ç»ƒå’Œæ¨ç†ï¼Œä»¥åŠè¿™äº›å› ç´ å¦‚ä½•å½±å“æˆ‘ä»¬å¸¸ç”¨ç®—æ³•çš„æ€§èƒ½ã€‚å…¶ä¸­ä¹Ÿæœ‰ä¸€äº›å†…å®¹å¯¹GPUç”¨æˆ·åŒæ ·é€‚ç”¨ï¼</p> </d-title> <d-byline>
<div class="byline grid">
<div class="authors-affiliations grid">
<h3 style="grid-column: 1; grid-row: 1;">ä½œè€…</h3>
<h3></h3>
<h3>æ‰€å±æœºæ„</h3>
<p class="author" style="grid-column: 1; grid-row: 2;">
<a class="name" href="https://www.jacobaustin.org/">Jacob Austin</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 2;">
<span class="affiliation">Google DeepMind</span>
</p>
<p class="author" style="grid-column: 1; grid-row: 3;">
<a class="name" href="https://x.com/_sholtodouglas">Sholto Douglas</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 3;">
<span class="affiliation"></span>
</p>
<p class="author" style="grid-column: 1; grid-row: 4;">
<a class="name" href="https://cs.stanford.edu/~rfrostig/">Roy Frostig</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 4;">
<span class="affiliation"></span>
</p>
<p class="author" style="grid-column: 1; grid-row: 5;">
<a class="name" href="https://anselmlevskaya.com/">Anselm Levskaya</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 5;">
<span class="affiliation"></span>
</p>
<p class="author" style="grid-column: 1; grid-row: 6;">
<a class="name" href="https://x.com/charliexychen">Charlie Chen</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 6;">
<span class="affiliation"></span>
</p>
<p class="author" style="grid-column: 1; grid-row: 7;">
<a class="name" href="https://sharadvikram.com/">Sharad Vikram</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 7;">
<span class="affiliation"></span>
</p>
<p class="author" style="grid-column: 2; grid-row: 2;">
<a class="name" href="https://fedelebron.com/">Federico Lebron</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 2;">
<span class="affiliation"></span>
</p>
<p class="author" style="grid-column: 2; grid-row: 3;">
<a class="name" href="https://x.com/pchoy95">Peter Choy</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 3;">
<span class="affiliation"></span>
</p>
<p class="author" style="grid-column: 2; grid-row: 4;">
<a class="name" href="https://x.com/vinayramasesh">Vinay Ramasesh</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 4;">
<span class="affiliation"></span>
</p>
<p class="author" style="grid-column: 2; grid-row: 5;">
<a class="name" href="https://representation.ai/">Albert Webson</a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 5;">
<span class="affiliation"></span>
</p>
<p class="author" style="grid-column: 2; grid-row: 6;">
<a class="name" href="https://x.com/reinerpope">Reiner Pope<sup>*</sup></a>
</p>
<p class="affiliation" style="grid-column: 3; grid-row: 6;">
<span class="affiliation"></span>
</p>
</div>
<div>
<h3>å‘å¸ƒæ—¥æœŸ</h3>
<p>2025å¹´2æœˆ4æ—¥</p>
</div>
</div>
</d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>ç›®å½•</h3> <div> <a href="#what-is-a-tpu">ä»€ä¹ˆæ˜¯TPUï¼Ÿ</a> </div> <div> <a href="#tpu-networking">TPUç½‘ç»œ</a> </div> <div> <a href="#key-takeaways">æ ¸å¿ƒè¦ç‚¹</a> </div> <div> <a href="#"></a> </div> <ul> <li> <a href="#tpu-specs">TPUè§„æ ¼</a> </li> </ul> <div> <a href="#worked-problems">ç»ƒä¹ é¢˜</a> </div> <div> <a href="#appendix">é™„å½•</a> </div> <div> <a href="#"></a> </div> <ul> <li> <a href="#appendix-a-more-on-tpu-internals">é™„å½•Aï¼šæ›´å¤šå…³äºTPUå†…éƒ¨çš„ç»†èŠ‚</a> </li> <li> <a href="#appendix-b-how-does-a-systolic-array-work">é™„å½•Bï¼šè„‰åŠ¨é˜µåˆ—æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</a> </li> </ul> </nav> </d-contents> <p class="announce">æ‚¨å¯èƒ½ä¹Ÿä¼šå¯¹å…³äºNVIDIA GPUçš„æ–°å¢<a href="gpus.html">ç¬¬12èŠ‚</a>æ„Ÿå…´è¶£ï¼</p> <h2 id="what-is-a-tpu">ä»€ä¹ˆæ˜¯TPUï¼Ÿ</h2> <p><strong>TPUæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºçŸ©é˜µä¹˜æ³•ï¼ˆç§°ä¸ºTensorCoreï¼‰çš„è®¡ç®—æ ¸å¿ƒï¼Œé™„å¸¦ä¸€ç»„é«˜é€Ÿå†…å­˜ï¼ˆç§°ä¸ºé«˜å¸¦å®½å†…å­˜æˆ–HBMï¼‰<d-cite key="tpu_paper"></d-cite>ã€‚</strong> ä¸‹å›¾æ˜¯ä¸€ä¸ªç¤ºæ„å›¾ï¼š</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/tpu-chip-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/tpu-chip-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/tpu-chip-1400.webp 1400w" type="image/webp"/> <img class="img-fluid" height="514" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/tpu-chip.png" width="1026"/> </picture> <figcaption class="caption"><b>å›¾ï¼š</b>TPUèŠ¯ç‰‡çš„åŸºæœ¬ç»„ä»¶ã€‚ç°è‰²çš„å·¦ä¾§æ–¹æ¡†æ˜¯TensorCoreï¼ŒåŒ…å«çŸ©é˜µä¹˜æ³•å•å…ƒï¼ˆMXUï¼‰ã€å‘é‡å•å…ƒï¼ˆVPUï¼‰å’Œå‘é‡å†…å­˜ï¼ˆVMEMï¼‰ã€‚</figcaption> </figure> <p>ä½ å¯ä»¥å°†TensorCoreçœ‹ä½œä¸€å°æ€§èƒ½æä½³çš„çŸ©é˜µä¹˜æ³•æœºå™¨ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€äº›å…¶ä»–å€¼å¾—æ³¨æ„çš„åŠŸèƒ½ã€‚TensorCoreæœ‰ä¸‰ä¸ªå…³é”®å•å…ƒï¼š</p> <ul> <li><strong>MXU</strong>ï¼ˆçŸ©é˜µä¹˜æ³•å•å…ƒï¼‰æ˜¯TensorCoreçš„æ ¸å¿ƒã€‚å¯¹äºå¤§å¤šæ•°TPUä»£é™…ï¼Œå®ƒä½¿ç”¨è„‰åŠ¨é˜µåˆ—ï¼ˆè¯¦è§<a href="#appendix-b-how-does-a-systolic-array-work">é™„å½•B</a>ï¼‰æ¯8ä¸ªå‘¨æœŸæ‰§è¡Œä¸€æ¬¡ <code class="language-plaintext highlighter-rouge">bfloat16[8,128] @ bf16[128,128] -&gt; f32[8,128]</code> çŸ©é˜µä¹˜æ³•<d-footnote id="d-footnote-1">TPU v6e (Trillium) æœ‰ä¸€ä¸ª256x256çš„MXUï¼Œè€Œä¹‹å‰æ‰€æœ‰ä»£é™…éƒ½ä½¿ç”¨128x128</d-footnote>ã€‚ <ul> <li>åœ¨TPU v5eä¸Šï¼Œè¿™å¤§çº¦æ˜¯æ¯ä¸ªMXU 1.5GHzæ—¶ <code class="language-plaintext highlighter-rouge">5e13</code> bfloat16 FLOPs/sã€‚å¤§å¤šæ•°TensorCoreæœ‰2æˆ–4ä¸ªMXUï¼Œå› æ­¤ä¾‹å¦‚TPU v5eçš„æ€»bfloat16 FLOPs/sä¸º <code class="language-plaintext highlighter-rouge">2e14</code>ã€‚</li> <li>TPUä¹Ÿæ”¯æŒæ›´é«˜ååé‡çš„ä½ç²¾åº¦çŸ©é˜µä¹˜æ³•ï¼ˆä¾‹å¦‚ï¼Œæ¯ä¸ªTPU v5eèŠ¯ç‰‡å¯ä»¥è¾¾åˆ° <code class="language-plaintext highlighter-rouge">4e14</code> int8 OPs/sï¼‰ã€‚</li> </ul> </li> <li><strong>VPU</strong>ï¼ˆå‘é‡å¤„ç†å•å…ƒï¼‰æ‰§è¡Œé€šç”¨çš„æ•°å­¦è¿ç®—ï¼Œå¦‚ReLUæ¿€æ´»å‡½æ•°æˆ–å‘é‡é—´çš„é€ç‚¹åŠ æ³•æˆ–ä¹˜æ³•ã€‚å½’çº¦ï¼ˆæ±‚å’Œï¼‰ä¹Ÿåœ¨è¿™é‡Œæ‰§è¡Œã€‚<a href="#appendix-a-more-on-tpu-internals">é™„å½•A</a>æä¾›äº†æ›´å¤šç»†èŠ‚ã€‚</li> <li> <strong>VMEM</strong>ï¼ˆå‘é‡å†…å­˜ï¼‰æ˜¯ä½äºTensorCoreå†…éƒ¨ã€é è¿‘è®¡ç®—å•å…ƒçš„ç‰‡ä¸Šæš‚å­˜åŒºã€‚å®ƒæ¯”HBMå°å¾—å¤šï¼ˆä¾‹å¦‚ï¼ŒTPU v5eä¸Šä¸º128 MiBï¼‰ï¼Œä½†ä¸MXUä¹‹é—´æœ‰æ›´é«˜çš„å¸¦å®½ã€‚VMEMçš„è¿ä½œæ–¹å¼æœ‰ç‚¹åƒCPUä¸Šçš„L1/L2ç¼“å­˜ï¼Œä½†å®¹é‡æ›´å¤§ä¸”ç”±ç¨‹åºå‘˜æ§åˆ¶ã€‚HBMä¸­çš„æ•°æ®éœ€è¦å…ˆå¤åˆ¶åˆ°VMEMä¸­ï¼ŒTensorCoreæ‰èƒ½å¯¹å…¶è¿›è¡Œè®¡ç®—ã€‚</li> </ul> <p><strong>TPUåœ¨çŸ©é˜µä¹˜æ³•æ–¹é¢éå¸¸éå¸¸å¿«</strong>ã€‚è¿™åŸºæœ¬ä¸Šæ˜¯å®ƒä»¬çš„ä¸»è¦å·¥ä½œï¼Œè€Œä¸”åšå¾—å¾ˆå¥½ã€‚<a href="https://cloud.google.com/tpu/docs/v5p#system_architecture" rel="external nofollow noopener" target="_blank">TPU v5p</a>æ˜¯è¿„ä»Šä¸ºæ­¢æœ€å¼ºå¤§çš„TPUä¹‹ä¸€ï¼Œæ¯ä¸ªæ ¸å¿ƒæ¯ç§’å¯ä»¥æ‰§è¡Œ <code class="language-plaintext highlighter-rouge">2.5e14</code> bfloat16 FLOPsï¼Œæˆ–è€…è¯´æ¯ä¸ªèŠ¯ç‰‡æ¯ç§’ <code class="language-plaintext highlighter-rouge">5e14</code> bfloat16 FLOPsã€‚ä¸€ä¸ªåŒ…å«8960ä¸ªèŠ¯ç‰‡çš„Podæ¯ç§’å¯ä»¥æ‰§è¡Œ4 exaflopsã€‚è¿™<em>éå¸¸</em>å¤šã€‚è¿™æ˜¯ä¸–ç•Œä¸Šæœ€å¼ºå¤§çš„è¶…çº§è®¡ç®—æœºä¹‹ä¸€ã€‚è€ŒGoogleæ‹¥æœ‰å¾ˆå¤šè¿™æ ·çš„æœºå™¨ã€‚<d-footnote id="d-footnote-2">TPUï¼Œç‰¹åˆ«æ˜¯å…¶è„‰åŠ¨é˜µåˆ—ï¼Œä¹‹æ‰€ä»¥æ˜¯å¦‚æ­¤å¼ºå¤§çš„ç¡¬ä»¶åŠ é€Ÿå™¨ï¼Œæ˜¯å› ä¸ºçŸ©é˜µä¹˜æ³•æ˜¯å°‘æ•°å‡ ä¸ªä½¿ç”¨ <d-math>O(n^3)</d-math> è®¡ç®—é‡å¤„ç† <d-math>O(n^2)</d-math> å­—èŠ‚æ•°æ®çš„ç®—æ³•ä¹‹ä¸€ã€‚è¿™ä½¿å¾—æ™®é€šçš„ALUå¾ˆå®¹æ˜“å—è®¡ç®—è€Œéå†…å­˜å¸¦å®½çš„é™åˆ¶ã€‚</d-footnote></p> <p>ä¸Šå›¾è¿˜åŒ…æ‹¬ä¸€äº›å…¶ä»–ç»„ä»¶ï¼Œå¦‚SMEMå’Œæ ‡é‡å•å…ƒï¼Œå®ƒä»¬ç”¨äºå¤„ç†æ§åˆ¶æµï¼Œåœ¨<a href="#appendix-a-more-on-tpu-internals">é™„å½•A</a>ä¸­æœ‰ç®€è¦è®¨è®ºï¼Œä½†ç†è§£å®ƒä»¬å¹¶éè‡³å…³é‡è¦ã€‚å¦ä¸€æ–¹é¢ï¼ŒHBMå¾ˆé‡è¦ä¸”ç›¸å½“ç®€å•ï¼š</p> <ul> <li> <p><strong>HBM</strong>ï¼ˆé«˜å¸¦å®½å†…å­˜ï¼‰æ˜¯ä¸€å¤§å—é«˜é€Ÿå†…å­˜ï¼Œç”¨äºå­˜å‚¨ä¾›TensorCoreä½¿ç”¨çš„å¼ é‡ã€‚HBMçš„å®¹é‡é€šå¸¸åœ¨å‡ åGBçš„é‡çº§ï¼ˆä¾‹å¦‚ï¼Œ<a href="https://cloud.google.com/tpu/docs/v5e#system_architecture" rel="external nofollow noopener" target="_blank">TPU v5eæ‹¥æœ‰16GiBçš„HBM</a>ï¼‰ã€‚</p> <ul> <li> <p>å½“è®¡ç®—éœ€è¦æ—¶ï¼Œå¼ é‡ä¼šé€šè¿‡VMEMï¼ˆè§ä¸‹æ–‡ï¼‰ä»HBMæµå¼ä¼ è¾“åˆ°MXUï¼Œç»“æœå†ä»VMEMå†™å›HBMã€‚</p> </li> <li> <p>HBMå’ŒTensorCoreä¹‹é—´çš„å¸¦å®½ï¼ˆé€šè¿‡VMEMï¼‰è¢«ç§°ä¸ºâ€œHBMå¸¦å®½â€ï¼ˆé€šå¸¸åœ¨1-2TB/ç§’å·¦å³ï¼‰ï¼Œå®ƒé™åˆ¶äº†å†…å­˜å¯†é›†å‹å·¥ä½œè´Ÿè½½çš„è®¡ç®—é€Ÿåº¦ã€‚</p> </li> </ul> </li> </ul> <p><strong>é€šå¸¸ï¼Œæ‰€æœ‰TPUæ“ä½œéƒ½æ˜¯æµæ°´çº¿åŒ–å’Œé‡å çš„ã€‚</strong>ä¸ºäº†æ‰§è¡Œä¸€æ¬¡çŸ©é˜µä¹˜æ³• <d-math>X \cdot A \to Y</d-math>ï¼ŒTPUé¦–å…ˆéœ€è¦å°†çŸ©é˜µ <d-math>A</d-math> å’Œ <d-math>X</d-math> çš„å—ä»HBMå¤åˆ¶åˆ°VMEMï¼Œç„¶åå°†å®ƒä»¬åŠ è½½åˆ°MXUä¸­ï¼ŒMXUä¼šä¹˜ä»¥8x128ï¼ˆå¯¹äº<d-math>X</d-math>ï¼‰å’Œ128x128ï¼ˆå¯¹äº<d-math>A</d-math>ï¼‰çš„å—ï¼Œç„¶åå°†ç»“æœé€å—å¤åˆ¶å›HBMã€‚ä¸ºäº†é«˜æ•ˆåœ°å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼ŒçŸ©é˜µä¹˜æ³•æ˜¯æµæ°´çº¿åŒ–çš„ï¼Œè¿™æ ·ä¸VMEMä¹‹é—´çš„æ•°æ®å¤åˆ¶å°±å¯ä»¥ä¸MXUçš„å·¥ä½œé‡å ã€‚è¿™ä½¿å¾—MXUå¯ä»¥æŒç»­å·¥ä½œï¼Œè€Œä¸æ˜¯ç­‰å¾…å†…å­˜ä¼ è¾“ï¼Œä»è€Œä½¿çŸ©é˜µä¹˜æ³•å—è®¡ç®—é™åˆ¶ï¼Œè€Œéå†…å­˜é™åˆ¶ã€‚</p> <p>è¿™æ˜¯ä¸€ä¸ªä»HBMæ‰§è¡Œé€å…ƒç´ ä¹˜æ³•çš„ä¾‹å­ï¼š</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/pointwise-product-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/pointwise-product-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/pointwise-product-1400.webp 1400w" type="image/webp"/> <img height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/pointwise-product.gif" width="100%"/> </picture> <figcaption class="caption"><b>å›¾ï¼š</b>ä¸€ä¸ªåŠ¨ç”»å±•ç¤ºäº†åœ¨TPUä¸Šæ‰§è¡Œçš„é€ç‚¹ä¹˜æ³•ï¼Œå­—èŠ‚ä»HBMåŠ è½½ã€‚æ³¨æ„å­—èŠ‚æ˜¯å¦‚ä½•ä»¥å—çš„å½¢å¼ä»å†…å­˜ä¸­æµå‡ºçš„ï¼Œä»¥åŠéƒ¨åˆ†ç»“æœæ˜¯å¦‚ä½•åœ¨ä¸ç­‰å¾…æ•´ä¸ªæ•°ç»„ç‰©åŒ–çš„æƒ…å†µä¸‹æµæ°´çº¿å¼åœ°å›ä¼ çš„ã€‚</figcaption> </figure> <p>ä¸€æ¬¡çŸ©é˜µä¹˜æ³•çœ‹èµ·æ¥å‡ ä¹å®Œå…¨ç›¸åŒï¼Œåªæ˜¯å®ƒä¼šåŠ è½½åˆ°MXUè€Œä¸æ˜¯VPU/å‘é‡å•å…ƒï¼Œå¹¶ä¸”åŠ è½½å’Œå­˜å‚¨çš„é¡ºåºä¼šä¸åŒï¼Œå› ä¸ºåŒä¸€ä¸ªæƒé‡å—ä¼šç”¨äºå¤šä¸ªæ¿€æ´»å—ã€‚ä½ å¯ä»¥çœ‹åˆ°æ•°æ®å—æµå‘VMEMï¼Œç„¶åè¿›å…¥VREGsï¼ˆå‘é‡å¯„å­˜å™¨ï¼‰ï¼Œæ¥ç€è¿›å…¥å‘é‡å•å…ƒï¼Œæœ€åå›åˆ°VMEMå’ŒHBMã€‚æˆ‘ä»¬é©¬ä¸Šä¼šçœ‹åˆ°ï¼Œå¦‚æœä»HBMåˆ°VMEMçš„åŠ è½½é€Ÿåº¦æ…¢äºå‘é‡å•å…ƒï¼ˆæˆ–MXUï¼‰çš„FLOPsï¼Œæˆ‘ä»¬å°±ä¼šå˜å¾—â€œå¸¦å®½å—é™â€ï¼Œå› ä¸ºVPUæˆ–MXUä¼šå› ç¼ºå°‘æ•°æ®è€Œç©ºé—²ã€‚</p> <p class="takeaway"><strong>æ ¸å¿ƒè¦ç‚¹ï¼š</strong>TPUéå¸¸ç®€å•ã€‚å®ƒä»¬å°†æƒé‡ä»HBMåŠ è½½åˆ°VMEMï¼Œç„¶åä»VMEMåŠ è½½åˆ°ä¸€ä¸ªè„‰åŠ¨é˜µåˆ—ä¸­ï¼Œè¯¥é˜µåˆ—æ¯ç§’å¯ä»¥æ‰§è¡Œçº¦200ä¸‡äº¿æ¬¡ä¹˜åŠ è¿ç®—ã€‚HBM <d-math>\leftrightarrow</d-math> VMEMå’ŒVMEM <d-math>\leftrightarrow</d-math> è„‰åŠ¨é˜µåˆ—çš„å¸¦å®½å¯¹TPUèƒ½é«˜æ•ˆæ‰§è¡Œå“ªäº›è®¡ç®—è®¾å®šäº†åŸºæœ¬é™åˆ¶ã€‚</p> <p><strong>VMEMå’Œè®¡ç®—å¼ºåº¦ï¼š</strong>VMEMæ¯”HBMå°å¾—å¤šï¼Œä½†å®ƒä¸MXUä¹‹é—´çš„å¸¦å®½è¦é«˜å¾—å¤šã€‚æ­£å¦‚æˆ‘ä»¬åœ¨<a href="roofline.html">ç¬¬1èŠ‚</a>ä¸­çœ‹åˆ°çš„ï¼Œè¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªç®—æ³•èƒ½å°†å…¶æ‰€æœ‰è¾“å…¥/è¾“å‡ºéƒ½æ”¾å…¥VMEMï¼Œå®ƒå°±æ›´ä¸å®¹æ˜“é‡åˆ°é€šä¿¡ç“¶é¢ˆã€‚å½“ä¸€ä¸ªè®¡ç®—çš„è®¡ç®—å¼ºåº¦è¾ƒä½æ—¶ï¼Œè¿™ä¸€ç‚¹å°¤å…¶æœ‰ç”¨ï¼šVMEMå¸¦å®½å¤§çº¦æ˜¯HBMå¸¦å®½çš„22å€ï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªä»VMEMè¯»å–/å†™å…¥çš„MXUæ“ä½œåªéœ€è¦10-20çš„è®¡ç®—å¼ºåº¦å°±èƒ½è¾¾åˆ°å³°å€¼FLOPsåˆ©ç”¨ç‡ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬èƒ½å°†æƒé‡æ”¾å…¥VMEMè€Œä¸æ˜¯HBMï¼Œæˆ‘ä»¬çš„çŸ©é˜µä¹˜æ³•å¯ä»¥åœ¨å°å¾—å¤šçš„æ‰¹é‡å¤§å°ä¸‹è¾¾åˆ°è®¡ç®—é™åˆ¶ã€‚è¿™ä¹Ÿæ„å‘³ç€é‚£äº›è®¡ç®—å¼ºåº¦å¤©ç”Ÿè¾ƒä½çš„ç®—æ³•ä»ç„¶å¯ä»¥æ˜¯é«˜æ•ˆçš„ã€‚åªæ˜¯VMEMå¤ªå°äº†ï¼Œè¿™å¸¸å¸¸æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚<d-footnote id="d-footnote-3">æˆ‘ä»¬æœ‰æ—¶ä¼šè°ˆåˆ°VMEMé¢„å–ï¼ŒæŒ‡çš„æ˜¯æå‰åœ¨VMEMä¸­åŠ è½½æƒé‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ©ç›–çŸ©é˜µä¹˜æ³•çš„åŠ è½½æˆæœ¬ã€‚ä¾‹å¦‚ï¼Œåœ¨æ ‡å‡†çš„Transformerä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶å¯ä»¥åœ¨æ³¨æ„åŠ›è®¡ç®—æœŸé—´å°†å¤§çš„å‰é¦ˆç½‘ç»œæƒé‡åŠ è½½åˆ°VMEMä¸­ï¼Œå¦‚æœæˆ‘ä»¬çš„å†…å­˜å¸¦å®½å—é™ï¼Œè¿™å¯ä»¥éšè—æƒé‡åŠ è½½çš„æˆæœ¬ã€‚è¿™è¦æ±‚æˆ‘ä»¬çš„æƒé‡è¶³å¤Ÿå°æˆ–åˆ†ç‰‡å¾—è¶³å¤Ÿç»†ï¼Œä»¥ä¾¿èƒ½å°†å•å±‚æƒé‡æ”¾å…¥VMEMå¹¶ç•™æœ‰ä½™åœ°ã€‚</d-footnote></p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/tpu-bandwidth-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/tpu-bandwidth-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/tpu-bandwidth-1400.webp 1400w" type="image/webp"/> <img class="img-fluid" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/tpu-bandwidth.png" width="100%"/> </picture> </figure> <p><strong>ä¸€ä¸ªTPUèŠ¯ç‰‡é€šå¸¸ï¼ˆä½†å¹¶éæ€»æ˜¯ï¼‰ç”±ä¸¤ä¸ªTPUæ ¸å¿ƒç»„æˆï¼Œå®ƒä»¬å…±äº«å†…å­˜ï¼Œå¯ä»¥è¢«çœ‹ä½œä¸€ä¸ªæ‹¥æœ‰ä¸¤å€FLOPsçš„å¤§å‹åŠ é€Ÿå™¨</strong>ï¼ˆç§°ä¸ºâ€œmegacoreâ€é…ç½®ï¼‰ã€‚è‡ªTPU v4ä»¥æ¥éƒ½æ˜¯å¦‚æ­¤ã€‚è¾ƒæ—©çš„TPUèŠ¯ç‰‡æœ‰ç‹¬ç«‹çš„å†…å­˜ï¼Œè¢«è§†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„åŠ é€Ÿå™¨ï¼ˆTPU v3åŠæ›´æ—©ç‰ˆæœ¬ï¼‰ã€‚åƒTPU v5eè¿™æ ·ä¸ºæ¨ç†ä¼˜åŒ–çš„èŠ¯ç‰‡æ¯ä¸ªèŠ¯ç‰‡åªæœ‰ä¸€ä¸ªTPUæ ¸å¿ƒã€‚</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/cores-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/cores-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/cores-1400.webp 1400w" type="image/webp"/> <img class="img-fluid img-small" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/cores.png" width="100%"/> </picture> </figure> <p><strong>èŠ¯ç‰‡</strong>ä»¥<strong>4ä¸ªä¸€ç»„çš„å½¢å¼æ’åˆ—åœ¨â€œæ‰˜ç›˜â€ä¸Š</strong>ï¼Œé€šè¿‡<strong>PCIeç½‘ç»œè¿æ¥åˆ°ä¸€ä¸ªCPUä¸»æœºã€‚</strong>è¿™æ˜¯å¤§å¤šæ•°è¯»è€…ä¼šç†Ÿæ‚‰çš„å½¢å¼ï¼Œå³é€šè¿‡Colabæˆ–å•ä¸ªTPU-VMæš´éœ²çš„4ä¸ªèŠ¯ç‰‡ï¼ˆ8ä¸ªæ ¸å¿ƒï¼Œä½†é€šå¸¸è¢«è§†ä¸º4ä¸ªé€»è¾‘megacoreï¼‰ã€‚å¯¹äºåƒTPU v5eè¿™æ ·çš„æ¨ç†èŠ¯ç‰‡ï¼Œæ¯ä¸ªä¸»æœºæœ‰2ä¸ªæ‰˜ç›˜ï¼Œè€Œä¸æ˜¯1ä¸ªï¼Œä½†æ¯ä¸ªèŠ¯ç‰‡ä¹Ÿåªæœ‰ä¸€ä¸ªæ ¸å¿ƒï¼Œå› æ­¤æˆ‘ä»¬æœ‰8ä¸ªèŠ¯ç‰‡ = 8ä¸ªæ ¸å¿ƒã€‚<d-footnote id="d-footnote-4">åœ¨Cloud TPU VMä¸Šï¼Œæ¯ä¸ªæ‰˜ç›˜éƒ½ä½œä¸ºç‹¬ç«‹VMçš„ä¸€éƒ¨åˆ†æš´éœ²å‡ºæ¥ï¼Œå› æ­¤å†æ¬¡å¯è§4ä¸ªæ ¸å¿ƒã€‚</d-footnote></p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/pcie-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/pcie-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/pcie-1400.webp 1400w" type="image/webp"/> <img class="img-fluid" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/pcie.png" width="100%"/> </picture> </figure> <p><strong>PCIeå¸¦å®½æ˜¯æœ‰é™çš„ï¼š</strong>ä¸HBM <d-math>\leftrightarrow</d-math> VMEMé“¾è·¯ä¸€æ ·ï¼ŒCPU <d-math>\leftrightarrow</d-math> HBMçš„PCIeè¿æ¥æœ‰ç‰¹å®šçš„å¸¦å®½ï¼Œè¿™é™åˆ¶äº†ä½ ä»ä¸»æœºå†…å­˜åŠ è½½åˆ°HBMæˆ–åä¹‹çš„é€Ÿåº¦ã€‚ä¾‹å¦‚ï¼ŒTPU v4çš„PCIeå¸¦å®½æ˜¯å•å‘16GB/ç§’ï¼Œæ‰€ä»¥æ¯”HBMæ…¢äº†è¿‘100å€ã€‚æˆ‘ä»¬<em>å¯ä»¥</em>å°†æ•°æ®åŠ è½½/å¸è½½åˆ°ä¸»æœºï¼ˆCPUï¼‰RAMä¸­ï¼Œä½†é€Ÿåº¦ä¸æ˜¯å¾ˆå¿«ã€‚</p> <h2 id="tpu-networking">TPUç½‘ç»œ</h2> <p><strong>åœ¨ä¸€ä¸ªPodä¸­ï¼ŒèŠ¯ç‰‡é€šè¿‡ICIç½‘ç»œç›¸äº’è¿æ¥</strong>ã€‚åœ¨è¾ƒæ—©çš„ä»£é™…ï¼ˆTPU v2å’ŒTPU v3ï¼‰ã€æ¨ç†èŠ¯ç‰‡ï¼ˆä¾‹å¦‚TPU v5eï¼‰å’ŒTriliumï¼ˆTPU v6eï¼‰ä¸­ï¼ŒICIï¼ˆâ€œèŠ¯ç‰‡é—´äº’è¿â€ï¼‰è¿æ¥4ä¸ªæœ€è¿‘çš„é‚»å±…ï¼ˆå¸¦æœ‰ç¯ç»•é“¾è·¯ä»¥å½¢æˆ2Dç¯é¢ï¼‰ã€‚TPU v4å’ŒTPU v5pè¿æ¥åˆ°æœ€è¿‘çš„6ä¸ªé‚»å±…ï¼ˆå½¢æˆ3Dç¯é¢ï¼‰ã€‚è¯·æ³¨æ„ï¼Œè¿™äº›è¿æ¥<strong>ä¸</strong>é€šè¿‡å®ƒä»¬çš„ä¸»æœºï¼Œè€Œæ˜¯èŠ¯ç‰‡ä¹‹é—´çš„ç›´æ¥é“¾è·¯ã€‚</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/ici-wraparound-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/ici-wraparound-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/ici-wraparound-1400.webp 1400w" type="image/webp"/> <img class="img-fluid img-small" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/ici-wraparound.png" width="100%"/> </picture> </figure> <p>ç¯é¢ç»“æ„å°†ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æœ€å¤§è·ç¦»ä»<d-math>N</d-math>å‡å°‘åˆ°<d-math>N / 2</d-math>ï¼Œä½¿å¾—é€šä¿¡å¿«å¾—å¤šã€‚TPUè¿˜æœ‰ä¸€ç§â€œæ‰­æ›²ç¯é¢â€é…ç½®ï¼Œå®ƒä»¥ç±»ä¼¼è«æ¯”ä¹Œæ–¯å¸¦çš„æ‹“æ‰‘ç»“æ„åŒ…è£¹ç¯é¢ï¼Œä»¥è¿›ä¸€æ­¥å‡å°èŠ‚ç‚¹é—´çš„å¹³å‡è·ç¦»ã€‚</p> <p><strong>TPU podï¼ˆé€šè¿‡ICIè¿æ¥ï¼‰å¯ä»¥å˜å¾—éå¸¸å¤§ï¼š</strong>æœ€å¤§çš„podå¤§å°ï¼ˆç§°ä¸º<strong>superpod</strong>ï¼‰å¯¹äºTPU v4æ˜¯ <code class="language-plaintext highlighter-rouge">16x16x16</code>ï¼Œå¯¹äºTPU v5pæ˜¯ <code class="language-plaintext highlighter-rouge">16x20x28</code>ã€‚è¿™äº›å¤§å‹podç”±å¯é‡æ„çš„ <code class="language-plaintext highlighter-rouge">4x4x4</code> èŠ¯ç‰‡ç«‹æ–¹ä½“ç»„æˆï¼Œé€šè¿‡<a href="https://arxiv.org/pdf/2208.10041" rel="external nofollow noopener" target="_blank">å…‰å­¦ç¯ç»•é“¾è·¯</a>è¿æ¥<d-footnote id="d-footnote-5">å…‰å­¦å¼€å…³åªæ˜¯ä¸€ä¸ªå…·æœ‰ç›¸åŒICIå¸¦å®½çš„å¯é‡æ„è¿æ¥ã€‚å®ƒåªæ˜¯è®©æˆ‘ä»¬åœ¨è¿æ¥ç«‹æ–¹ä½“çš„åŒæ—¶ä¿ç•™ç¯ç»•é“¾è·¯ã€‚</d-footnote>ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°é…ç½®å®ƒä»¬ä»¥è¿æ¥éå¸¸å¤§çš„æ‹“æ‰‘ã€‚</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/tpu-rack-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/tpu-rack-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/tpu-rack-1400.webp 1400w" type="image/webp"/> <img class="img-fluid" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/tpu-rack.png" width="100%"/> </picture> </figure> <p>ä¹Ÿå¯ä»¥è¯·æ±‚è¾ƒå°çš„æ‹“æ‰‘ï¼ˆä¾‹å¦‚<code class="language-plaintext highlighter-rouge">2x2x1</code>, <code class="language-plaintext highlighter-rouge">2x2x2</code>ï¼‰ï¼Œä½†æ²¡æœ‰ç¯ç»•è¿æ¥ã€‚è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ³¨æ„äº‹é¡¹ï¼Œå› ä¸ºå®ƒé€šå¸¸ä¼šä½¿å¤§å¤šæ•°é€šä¿¡æ—¶é—´åŠ å€ã€‚ä»»ä½•å®Œæ•´ç«‹æ–¹ä½“çš„å€æ•°ï¼ˆä¾‹å¦‚<code class="language-plaintext highlighter-rouge">4x4x4</code>æˆ–<code class="language-plaintext highlighter-rouge">4x4x8</code>ï¼‰éƒ½å°†ç”±å…‰å¼€å…³æä¾›ç¯ç»•è¿æ¥ã€‚<d-footnote id="d-footnote-6">è¯·æ³¨æ„ï¼Œä¸€ä¸ª `2x2x4` ä¸ä¼šæœ‰ä»»ä½•ç¯ç»•è¿æ¥ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç”±å…‰å¼€å…³æä¾›çš„ï¼Œè€Œå…‰å¼€å…³åªåœ¨å®Œæ•´çš„ç«‹æ–¹ä½“ä¸Šå¯ç”¨ã€‚ç„¶è€Œï¼Œä¸€ä¸ªTPU v5e 8x16 _å°†_åœ¨è¾ƒé•¿çš„è½´ä¸Šæœ‰ç¯ç»•è¿æ¥ï¼Œå› ä¸ºå®ƒä¸ä½¿ç”¨å¯é‡æ„çš„å…‰ç½‘ç»œã€‚</d-footnote></p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/subslices-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/subslices-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/subslices-1400.webp 1400w" type="image/webp"/> <img class="img-fluid" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/subslices.png" width="100%"/> </picture> </figure> <p>TPU v5eå’ŒTrillium podç”±å•ä¸ª <code class="language-plaintext highlighter-rouge">16x16</code> 2Dç¯é¢ç»„æˆï¼Œåœ¨ä»»ä½•å¤§å°ä¸º16çš„è½´ä¸Šéƒ½æœ‰ç¯ç»•è¿æ¥ï¼ˆè¿™æ„å‘³ç€ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">8x16</code> åœ¨é•¿è½´ä¸Šæœ‰ç¯ç»•è¿æ¥ï¼‰ã€‚TPU v5eå’Œv6eï¼ˆTrilliumï¼‰ä¸èƒ½æ‰©å±•åˆ°è¶…è¿‡16x16çš„ç¯é¢ï¼Œä½†podä¹‹é—´ä»ç„¶å¯ä»¥é€šè¿‡æ ‡å‡†çš„æ•°æ®ä¸­å¿ƒç½‘ç»œï¼ˆDCNï¼‰è¿›è¡Œé€šä¿¡ï¼ŒDCNè¿æ¥TPUä¸»æœºã€‚åŒæ ·ï¼Œå¯ä»¥è¯·æ±‚æ²¡æœ‰ç¯ç»•è¿æ¥çš„è¾ƒå°æ‹“æ‰‘ï¼Œå…¶ç»´åº¦<d-math>&lt;16</d-math>ã€‚</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/more-subslices-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/more-subslices-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/more-subslices-1400.webp 1400w" type="image/webp"/> <img class="img-fluid" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/more-subslices.png" width="100%"/> </picture> </figure> <p><strong>è¿™ç§æœ€è¿‘é‚»è¿æ¥æ˜¯TPUå’ŒGPUä¹‹é—´çš„ä¸€ä¸ªå…³é”®åŒºåˆ«</strong>ã€‚GPUé€šè¿‡ä¸€ä¸ªåˆ†å±‚çš„äº¤æ¢æœºç½‘ç»œè¿æ¥ï¼Œè¿‘ä¼¼äºæ¯ä¸ªGPUä¹‹é—´çš„ç‚¹å¯¹ç‚¹è¿æ¥ï¼Œè€Œä¸æ˜¯åƒTPUé‚£æ ·ä½¿ç”¨å±€éƒ¨è¿æ¥ã€‚é€šå¸¸ï¼Œä¸€ä¸ªèŠ‚ç‚¹å†…çš„GPUï¼ˆH100ä¸º8ä¸ªGPUï¼ŒB200å¤šè¾¾500ä¸ªï¼‰æ˜¯ç›´æ¥è¿æ¥çš„ï¼Œè€Œæ›´å¤§çš„æ‹“æ‰‘åˆ™éœ€è¦åœ¨æ¯ä¸ªGPUä¹‹é—´è¿›è¡ŒO(log(N))æ¬¡è·³è·ƒã€‚ä¸€æ–¹é¢ï¼Œè¿™æ„å‘³ç€GPUå¯ä»¥åœ¨ä¸€ä¸ªèŠ‚ç‚¹å†…ä»¥å•æ¬¡ä½å»¶è¿Ÿè·³è·ƒå‘é€ä»»æ„æ•°æ®ã€‚å¦ä¸€æ–¹é¢ï¼ŒTPUçš„æˆæœ¬è¦ä½å¾—å¤šï¼ˆå› ä¸ºNVLinkäº¤æ¢æœºå¾ˆæ˜‚è´µï¼‰ï¼Œå¸ƒçº¿æ›´ç®€å•ï¼Œå¹¶ä¸”å¯ä»¥æ‰©å±•åˆ°æ›´å¤§çš„æ‹“æ‰‘ï¼Œå› ä¸ºæ¯ä¸ªè®¾å¤‡çš„é“¾è·¯æ•°å’Œæ¯ä¸ªè®¾å¤‡çš„å¸¦å®½æ˜¯æ’å®šçš„ã€‚åœ¨æ­¤å¤„é˜…è¯»æ›´å¤šä¿¡æ¯<a href="https://jax-ml.github.io/scaling-book/gpus#networking">here</a>ã€‚</p> <p><strong>ICIç›¸å¯¹äºDCNéå¸¸å¿«ï¼Œä½†ä»æ¯”HBMå¸¦å®½æ…¢ã€‚</strong>ä¾‹å¦‚ï¼Œä¸€ä¸ª<a href="https://cloud.google.com/tpu/docs/v5p#system_architecture" rel="external nofollow noopener" target="_blank">TPU v5p</a>å…·æœ‰ï¼š</p> <ul> <li> æ¯ä¸ªèŠ¯ç‰‡ <code class="language-plaintext highlighter-rouge">2.5e12</code> å­—èŠ‚/ç§’ (2.5 TB/s) çš„HBMå¸¦å®½ã€‚</li> <li> æ¯ä¸ªè½´ <code class="language-plaintext highlighter-rouge">9e10</code> å­—èŠ‚/ç§’ (90 GB/s) çš„ICIå¸¦å®½ï¼Œæ¯ä¸ªèŠ¯ç‰‡æœ‰3ä¸ªè½´ã€‚<d-footnote id="d-footnote-7">ä¸Šè¿°é¡µé¢åˆ—å‡ºçš„å¸¦å®½ä¸º100 GB/sï¼Œä¸æ­¤å¤„åˆ—å‡ºçš„ç•¥æœ‰ä¸åŒã€‚TPU ICIé“¾è·¯çš„å¸¦å®½æ ¹æ®æ‰§è¡Œçš„æ“ä½œç•¥æœ‰ä¸åŒã€‚ä½ é€šå¸¸å¯ä»¥æ”¾å¿ƒä½¿ç”¨æœ¬æ–‡æ¡£ä¸­çš„æ•°å­—ã€‚</d-footnote> </li> <li> æ¯ä¸ªTPU <code class="language-plaintext highlighter-rouge">6.25e9</code> å­—èŠ‚/ç§’ (6.25 GB/s) çš„DCNï¼ˆå‡ºå£ï¼‰å¸¦å®½ï¼ˆé€šè¿‡æ¯ä¸ªä¸»æœºä¸Šçš„1-2ä¸ªNICï¼‰ã€‚<d-footnote id="d-footnote-8">TPU v6eä¸º12.5e9å­—èŠ‚/ç§’ï¼Œv5eä¸º3.125e9å­—èŠ‚/ç§’ã€‚</d-footnote> </li> </ul> <p>è¿™æ„å‘³ç€å½“æˆ‘ä»¬åœ¨å¤šä¸ªèŠ¯ç‰‡ä¸Šåˆ†å‰²æ¨¡å‹æ—¶ï¼Œéœ€è¦å°å¿ƒé¿å…å› è¾ƒæ…¢çš„è·¨è®¾å¤‡é€šä¿¡è€Œä½¿MXUæˆä¸ºç“¶é¢ˆã€‚</p> <p><strong>å¤šsliceè®­ç»ƒï¼š</strong>ä¸€ç»„é€šè¿‡ICIè¿æ¥çš„TPUç§°ä¸ºä¸€ä¸ª<strong>slice</strong>ã€‚ä¸åŒçš„sliceä¹‹é—´å¯ä»¥é€šè¿‡DCNè¿æ¥ï¼Œä¾‹å¦‚è¿æ¥ä¸åŒpodä¸Šçš„sliceã€‚ç”±äºDCNæ˜¯æ¯”ICIæ…¢å¾—å¤šçš„è¿æ¥ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡é™åˆ¶è®¡ç®—ç­‰å¾…æ¥è‡ªDCNæ•°æ®çš„æ—¶é—´ã€‚DCNæ˜¯ä¸»æœºåˆ°ä¸»æœºçš„ï¼Œå› æ­¤è¦é€šè¿‡DCNå°†ç¼“å†²åŒºä»ä¸€ä¸ªTPUä¼ è¾“åˆ°å¦ä¸€ä¸ªTPUï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡PCIeä¼ è¾“åˆ°ä¸»æœºï¼Œç„¶åé€šè¿‡ç½‘ç»œå‡ºå£ï¼Œå†é€šè¿‡ç›®æ ‡ä¸»æœºçš„ç½‘ç»œå…¥å£ï¼Œæœ€åé€šè¿‡PCIeè¿›å…¥HBMã€‚</p> <h2 id="key-takeaways">æ ¸å¿ƒè¦ç‚¹</h2> <ul> <li> <p>TPUå¾ˆç®€å•ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥è¢«çœ‹ä½œä¸€ä¸ªçŸ©é˜µä¹˜æ³•å•å…ƒï¼Œå®ƒè¿æ¥åˆ°å†…å­˜ï¼ˆè¶…å¿«ï¼‰ã€é€šè¿‡ICIè¿æ¥åˆ°å…¶ä»–èŠ¯ç‰‡ï¼ˆç›¸å½“å¿«ï¼‰ï¼Œä»¥åŠé€šè¿‡DCNè¿æ¥åˆ°æ•°æ®ä¸­å¿ƒçš„å…¶ä»–éƒ¨åˆ†ï¼ˆé€Ÿåº¦å°šå¯ï¼‰ã€‚</p> </li> <li>é€šä¿¡å—é™äºæˆ‘ä»¬å„ç§ç½‘ç»œå¸¦å®½ï¼ŒæŒ‰é€Ÿåº¦æ’åºï¼š <ul> <li>HBMå¸¦å®½ï¼šåœ¨TensorCoreä¸å…¶å…³è”çš„HBMä¹‹é—´ã€‚</li> <li>ICIå¸¦å®½ï¼šåœ¨ä¸€ä¸ªTPUèŠ¯ç‰‡ä¸å…¶æœ€è¿‘çš„4æˆ–6ä¸ªé‚»å±…ä¹‹é—´ã€‚</li> <li>PCIeå¸¦å®½ï¼šåœ¨ä¸€ä¸ªCPUä¸»æœºä¸å…¶å…³è”çš„èŠ¯ç‰‡æ‰˜ç›˜ä¹‹é—´ã€‚</li> <li>DCNå¸¦å®½ï¼šåœ¨å¤šä¸ªCPUä¸»æœºä¹‹é—´ï¼Œé€šå¸¸æ˜¯æœªé€šè¿‡ICIè¿æ¥çš„ä¸»æœºã€‚</li> </ul> </li> <li> <p><strong>åœ¨ä¸€ä¸ªsliceå†…éƒ¨ï¼ŒTPUä»…é€šè¿‡ICIè¿æ¥åˆ°å…¶æœ€è¿‘çš„é‚»å±…ã€‚</strong>è¿™æ„å‘³ç€åœ¨ä¸€ä¸ªsliceå†…ï¼Œè¿œè·ç¦»èŠ¯ç‰‡ä¹‹é—´çš„ICIé€šä¿¡éœ€è¦å…ˆè·³è¿‡ä¸­é—´çš„èŠ¯ç‰‡ã€‚</p> </li> <li> <p><strong>æƒé‡çŸ©é˜µåœ¨ä¸¤ä¸ªç»´åº¦ä¸Šéƒ½éœ€è¦å¡«å……åˆ°è‡³å°‘128çš„å¤§å°</strong>ï¼ˆåœ¨TPU v6ä¸Šæ˜¯256ï¼‰ï¼Œä»¥å¡«æ»¡MXUï¼ˆå®é™…ä¸Šï¼Œè¾ƒå°çš„è½´ä¼šè¢«å¡«å……åˆ°128ï¼‰ã€‚</p> </li> <li> <p><strong>è¾ƒä½ç²¾åº¦çš„çŸ©é˜µä¹˜æ³•é€šå¸¸æ›´å¿«ã€‚</strong>å¯¹äºæ”¯æŒå®ƒçš„ä»£é™…ï¼ŒTPUæ‰§è¡Œint8æˆ–int4 FLOPsçš„é€Ÿåº¦å¤§çº¦æ˜¯bfloat16 FLOPsçš„2å€/4å€ã€‚VPUæ“ä½œä»ç„¶ä»¥fp32æ‰§è¡Œã€‚</p> </li> <li>ä¸ºäº†é¿å…TPUè®¡ç®—å•å…ƒæˆä¸ºç“¶é¢ˆï¼Œæˆ‘ä»¬éœ€è¦<strong>ç¡®ä¿æ¯ä¸ªé€šé“ä¸Šçš„é€šä¿¡é‡ä¸å…¶é€Ÿåº¦æˆæ¯”ä¾‹</strong>ã€‚</li> </ul> <h3 id="tpu-specs">TPUè§„æ ¼</h3> <p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬èŠ¯ç‰‡çš„ä¸€äº›å…·ä½“æ•°å­—ï¼š</p> <table class="table-hover" data-toggle="table"> <thead> <tr> <th style="text-align: left">å‹å·</th> <th style="text-align: center">Podå¤§å°</th> <th style="text-align: center">ä¸»æœºå¤§å°</th> <th style="text-align: center">HBMå®¹é‡/èŠ¯ç‰‡</th> <th style="text-align: center">HBMå¸¦å®½/èŠ¯ç‰‡ (å­—èŠ‚/ç§’)</th> <th style="text-align: center">FLOPs/ç§’/èŠ¯ç‰‡ (bf16)</th> <th style="text-align: center">FLOPs/ç§’/èŠ¯ç‰‡ (int8)</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><span class="nowrap-header">TPU v3</span></td> <td style="text-align: center">32x32</td> <td style="text-align: center">4x2</td> <td style="text-align: center">32GB</td> <td style="text-align: center">9.0e11</td> <td style="text-align: center">1.4e14</td> <td style="text-align: center">1.4e14</td> </tr> <tr> <td style="text-align: left"><span class="nowrap-header">TPU v4p</span></td> <td style="text-align: center">16x16x16</td> <td style="text-align: center">2x2x1</td> <td style="text-align: center">32GB</td> <td style="text-align: center">1.2e12</td> <td style="text-align: center">2.75e14</td> <td style="text-align: center">2.75e14</td> </tr> <tr> <td style="text-align: left"><span class="nowrap-header">TPU v5p</span></td> <td style="text-align: center">16x20x28</td> <td style="text-align: center">2x2x1</td> <td style="text-align: center">96GB</td> <td style="text-align: center">2.8e12</td> <td style="text-align: center">4.59e14</td> <td style="text-align: center">9.18e14</td> </tr> <tr> <td style="text-align: left"><span class="nowrap-header">TPU v5e</span></td> <td style="text-align: center">16x16</td> <td style="text-align: center">4x2</td> <td style="text-align: center">16GB</td> <td style="text-align: center">8.1e11</td> <td style="text-align: center">1.97e14</td> <td style="text-align: center">3.94e14</td> </tr> <tr> <td style="text-align: left"><span class="nowrap-header">TPU v6e</span></td> <td style="text-align: center">16x16</td> <td style="text-align: center">4x2</td> <td style="text-align: center">32GB</td> <td style="text-align: center">1.6e12</td> <td style="text-align: center">9.20e14</td> <td style="text-align: center">1.84e15</td> </tr> </tbody> </table> <p>ä¸»æœºå¤§å°æŒ‡çš„æ˜¯è¿æ¥åˆ°å•ä¸ªä¸»æœºçš„TPUæ‹“æ‰‘ï¼ˆä¾‹å¦‚ï¼ŒTPU v5eæœ‰ä¸€ä¸ªCPUä¸»æœºè¿æ¥åˆ°8ä¸ªå‘ˆ4x2æ‹“æ‰‘çš„TPUï¼‰ã€‚ä»¥ä¸‹æ˜¯äº’è¿æ•°æ®ï¼š</p> <table class="table-hover" data-toggle="table"> <thead> <tr> <th style="text-align: left">å‹å·</th> <th style="text-align: center">ICIå¸¦å®½/é“¾è·¯ (å•å‘, å­—èŠ‚/ç§’)</th> <th style="text-align: center">ICIå¸¦å®½/é“¾è·¯ (åŒå‘, å­—èŠ‚/ç§’)</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>TPU v3</strong></td> <td style="text-align: center">1e11</td> <td style="text-align: center">2e11</td> </tr> <tr> <td style="text-align: left"><strong>TPU v4p</strong></td> <td style="text-align: center">4.5e10</td> <td style="text-align: center">9e10</td> </tr> <tr> <td style="text-align: left"><strong>TPU v5p</strong></td> <td style="text-align: center">9e10</td> <td style="text-align: center">1.8e11</td> </tr> <tr> <td style="text-align: left"><strong>TPU v5e</strong></td> <td style="text-align: center">4.5e10</td> <td style="text-align: center">9e10</td> </tr> <tr> <td style="text-align: left"><strong>TPU v6e</strong></td> <td style="text-align: center">9e10</td> <td style="text-align: center">1.8e11</td> </tr> </tbody> </table> <p>æˆ‘ä»¬åŒæ—¶æä¾›äº†å•å‘ï¼ˆunidirectionalï¼‰å¸¦å®½å’ŒåŒå‘ï¼ˆbidirectionalï¼‰å¸¦å®½ï¼Œå› ä¸ºå•å‘å¸¦å®½æ›´æ¥è¿‘ç¡¬ä»¶å®é™…æƒ…å†µï¼Œä½†åŒå‘å¸¦å®½åœ¨æ¶‰åŠå®Œæ•´ç¯å½¢ç½‘ç»œçš„æ–¹ç¨‹ä¸­æ›´å¸¸å‡ºç°ã€‚<d-footnote id="d-footnote-9">æˆ‘ä»¬æ‰€è¯´çš„åŒå‘ï¼ˆbidiï¼‰å¸¦å®½æ˜¯æŒ‡å•ä¸ªé“¾è·¯ä¸ŠåŒå‘å¯å‘é€çš„æ€»å­—èŠ‚æ•°ï¼Œæˆ–è€…ç­‰åŒäºï¼Œå‡è®¾æˆ‘ä»¬å¯ä»¥é«˜æ•ˆåœ°ä½¿ç”¨ä¸¤ä¸ªé“¾è·¯ï¼Œå•ä¸ªTPUæ²¿ç‰¹å®šè½´çš„æ€»å‡ºå‘å­—èŠ‚æ•°ã€‚å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªåŠŸèƒ½æ­£å¸¸çš„ç¯å½¢ç½‘ç»œæ—¶ï¼Œå³å½“æˆ‘ä»¬åœ¨ç‰¹å®šè½´ä¸Šæœ‰ç¯ç»•è¿æ¥æ—¶ï¼Œè¿™æ˜¯æˆç«‹çš„ã€‚è¿™åœ¨æ¨ç†èŠ¯ç‰‡ä¸Šå½“æˆ‘ä»¬æœ‰ä¸€ä¸ªå®Œæ•´çš„16è½´æ—¶å‘ç”Ÿï¼Œæˆ–è€…åœ¨è®­ç»ƒèŠ¯ç‰‡ï¼ˆv*pï¼‰ä¸Šå½“æˆ‘ä»¬æœ‰ä¸€ä¸ªæ˜¯4çš„å€æ•°çš„è½´æ—¶å‘ç”Ÿã€‚æˆ‘ä»¬æ›´å–œæ¬¢ä½¿ç”¨åŒå‘å¸¦å®½ï¼Œå› ä¸ºå®ƒåœ¨æ¶‰åŠåŒå‘é€šä¿¡çš„è®¡ç®—ä¸­é¢‘ç¹å‡ºç°ã€‚</d-footnote></p> <p>PCIeå¸¦å®½é€šå¸¸çº¦ä¸ºæ¯ä¸ªTPU <code class="language-plaintext highlighter-rouge">1.6e10</code> å­—èŠ‚/ç§’ï¼ˆTPU v6eä¸º <code class="language-plaintext highlighter-rouge">3.2e10</code>ï¼‰ï¼Œè€ŒDCNå¸¦å®½é€šå¸¸çº¦ä¸ºæ¯ä¸ªTPU <code class="language-plaintext highlighter-rouge">6.25e9</code> å­—èŠ‚/ç§’ï¼ˆTPU v6eä¸º <code class="language-plaintext highlighter-rouge">12.5e9</code>ï¼ŒTPU v5eä¸º <code class="language-plaintext highlighter-rouge">3.125e9</code>ï¼‰ã€‚</p> <h2 id="worked-problems">ç»ƒä¹ é¢˜</h2> <p>è¿™äº›æ•°å­—å¯èƒ½æœ‰äº›æ¯ç‡¥ï¼Œä½†å®ƒä»¬èƒ½è®©ä½ å¯¹æ¨¡å‹æ€§èƒ½åšå‡ºåŸºæœ¬çš„Rooflineä¼°ç®—ã€‚è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªé—®é¢˜æ¥è§£é‡Šä¸ºä»€ä¹ˆè¿™å¾ˆæœ‰ç”¨ã€‚ä½ å°†åœ¨ç¬¬3éƒ¨åˆ†çœ‹åˆ°æ›´å¤šä¾‹å­ã€‚</p> <p><strong>é—®é¢˜1 [LLMå»¶è¿Ÿçš„ç•Œå®š]ï¼š</strong>å‡è®¾ä½ æƒ³ä»ä¸€ä¸ªåˆ†å¸ƒåœ¨32ä¸ªTPU v4pä¸Šçš„200Bå‚æ•°çš„bf16æ¨¡å‹ä¸­è¿›è¡Œé‡‡æ ·ã€‚å°†æ‰€æœ‰å‚æ•°ä»HBMåŠ è½½åˆ°è„‰åŠ¨é˜µåˆ—éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ<em>æç¤ºï¼šä½¿ç”¨ä¸Šé¢çš„æ•°å­—ã€‚</em></p> <details><summary>ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹ç­”æ¡ˆã€‚</summary> <p><strong>ç­”æ¡ˆï¼š</strong>æˆ‘ä»¬åœ¨32ä¸ªèŠ¯ç‰‡ä¸ŠåŠ è½½ <code class="language-plaintext highlighter-rouge">sizeof(bf16) * 200e9 = 400e9</code> å­—èŠ‚ï¼Œå³æ¯ä¸ªèŠ¯ç‰‡12.5e9å­—èŠ‚ï¼Œæ¯ä¸ªèŠ¯ç‰‡çš„HBMå¸¦å®½ä¸º1.23e12ã€‚æ‰€ä»¥åŠ è½½å¤§çº¦éœ€è¦10æ¯«ç§’ã€‚</p> <p>è¿™å¾ˆé…·ï¼Œå› ä¸º<em>è¿™æ˜¯å¯¹æ¨¡å‹é‡‡æ ·å»¶è¿Ÿçš„ä¸€ä¸ªåˆç†çš„ä¸‹ç•Œ</em>ã€‚æ¯ä¸ªé‡‡æ ·æ­¥éª¤éƒ½éœ€è¦ä»HBMåŠ è½½æ‰€æœ‰å‚æ•°ï¼Œæ‰€ä»¥è€—æ—¶ä¸å¯èƒ½å°‘äº10æ¯«ç§’ã€‚å®é™…ä¸Šï¼Œåœ¨å°æ‰¹é‡å¤§å°ä¸‹ï¼Œè¿™å‡ ä¹æ˜¯å¯ä»¥å®ç°çš„ã€‚</p> </details> <p><strong>é—®é¢˜2 [TPUç»†èŠ‚]ï¼š</strong>è€ƒè™‘ä¸€ä¸ªå®Œæ•´çš„TPU v5e podã€‚æ€»å…±æœ‰å¤šå°‘ä¸ªCPUä¸»æœºï¼Ÿå¤šå°‘ä¸ªTPU TensorCoreï¼Ÿæ•´ä¸ªpodçš„æ€»FLOPs/sæ˜¯å¤šå°‘ï¼Ÿæ€»HBMæ˜¯å¤šå°‘ï¼Ÿå¯¹TPU v5p podåšåŒæ ·çš„ç»ƒä¹ ã€‚</p> <details><summary>ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹ç­”æ¡ˆã€‚</summary> <p><strong>ç­”æ¡ˆï¼š</strong>å¯¹äºTPU v5eï¼Œæ¯ä¸ªpodæ˜¯ <code class="language-plaintext highlighter-rouge">16x16</code>ï¼Œæ¯ä¸ªä¸»æœºæ˜¯ä¸€ä¸ª4x2çš„sliceï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ <code class="language-plaintext highlighter-rouge">16*16 / 8 = 32</code> ä¸ªä¸»æœºã€‚å¯¹äºTPU v5eï¼Œæ¯ä¸ªTPUåªæœ‰ä¸€ä¸ªæ ¸å¿ƒï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰256ä¸ªTensorCoreã€‚æ€»FLOPs/sæ˜¯ <code class="language-plaintext highlighter-rouge">16*16*2e14 = 5.1e16</code> bfloat16ã€‚æ¯ä¸ªèŠ¯ç‰‡æœ‰16GBçš„HBMï¼Œæ‰€ä»¥æ€»å†…å­˜æ˜¯ <code class="language-plaintext highlighter-rouge">256 * 16 = 4TB</code>ã€‚</p> <p>å¯¹äºä¸€ä¸ªå®Œæ•´çš„TPU v5p podï¼Œæˆ‘ä»¬æœ‰ <code class="language-plaintext highlighter-rouge">16x20x28</code> ä¸ªèŠ¯ç‰‡ï¼Œæ¯ä¸ªä¸»æœºæ˜¯2x2x1ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ <code class="language-plaintext highlighter-rouge">16*20*28 / 2*2 = 2,240</code> ä¸ªä¸»æœºã€‚å¯¹äºTPU v5pï¼Œæ¯ä¸ªTPUæœ‰ä¸¤ä¸ªTensorCoreï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ <code class="language-plaintext highlighter-rouge">8960 * 2 = 17,920</code> ä¸ªæ ¸å¿ƒã€‚æ€»FLOPs/sæ˜¯ <code class="language-plaintext highlighter-rouge">8960 * 4.5e14 = 4e18</code> bfloat16ã€‚æ¯ä¸ªèŠ¯ç‰‡æœ‰96GBçš„HBMï¼Œæ‰€ä»¥æ€»å†…å­˜æ˜¯ <code class="language-plaintext highlighter-rouge">8960 * 96 = 860TB</code>ã€‚</p> </details> <p><strong>é—®é¢˜3 [PCIeæ“ä½œå¼ºåº¦]ï¼š</strong>æƒ³è±¡æˆ‘ä»¬è¢«è¿«å°†ä¸€ä¸ªå¤§çš„æƒé‡çŸ©é˜µ <d-math>A</d-math>ï¼ˆç±»å‹ä¸º <d-math>\text{bfloat16}[D, F]</d-math>ï¼‰å’Œä¸€æ‰¹æ¿€æ´» <d-math>x</d-math>ï¼ˆç±»å‹ä¸º <d-math>\text{bfloat16}[B, D]</d-math>ï¼‰å­˜å‚¨åœ¨ä¸»æœºDRAMä¸­ï¼Œå¹¶æƒ³åœ¨å®ƒä»¬ä¸Šé¢è¿›è¡ŒçŸ©é˜µä¹˜æ³•ã€‚è¿™åœ¨å•ä¸ªä¸»æœºä¸Šè¿è¡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªä¸ä¹‹ç›¸è¿çš„TPU v6eèŠ¯ç‰‡ã€‚ä½ å¯ä»¥å‡è®¾ <d-math>B \ll D</d-math>ï¼Œå’Œ <d-math>F = 4D</d-math>ï¼ˆåœ¨æœªæ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸ºä»€ä¹ˆè¿™äº›æ˜¯åˆç†çš„å‡è®¾ï¼‰ã€‚æˆ‘ä»¬éœ€è¦å¤šå¤§çš„æœ€å°æ‰¹é‡å¤§å° <d-math>B</d-math> æ‰èƒ½åœ¨PCIeä¸Šä¿æŒè®¡ç®—é™åˆ¶ï¼Ÿå‡è®¾PCIeå¸¦å®½ä¸º1.5e10å­—èŠ‚/ç§’ã€‚</p> <details><summary>ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹ç­”æ¡ˆã€‚</summary> <p><strong>ç­”æ¡ˆï¼š</strong>æˆ‘ä»¬éœ€è¦æ‰§è¡Œ <d-math>2BDF</d-math> æ¬¡æµ®ç‚¹è¿ç®—ï¼Œæ¯ä¸ªèŠ¯ç‰‡æ¯ç§’å¯ä»¥æ‰§è¡Œ <code class="language-plaintext highlighter-rouge">9.2e14</code> æ¬¡æµ®ç‚¹è¿ç®—ã€‚è¿™éœ€è¦ <d-math>2BDF / 9.2e14</d-math> ç§’æ¥å®Œæˆã€‚æˆ‘ä»¬éœ€è¦ä»DRAMåŠ è½½ <d-math>2DF + 2BD</d-math> å­—èŠ‚ï¼Œå¹¶å°† <d-math>2BF</d-math> å­—èŠ‚å†™å›ã€‚æˆ‘ä»¬å—é™äºPCIeä¼ è¾“é€Ÿåº¦ï¼Œæ‰€ä»¥éœ€è¦ <d-math>2 \cdot (BD + DF + BF) / 1.5e10</d-math> ç§’æ¥ä¸TPUè¿›è¡Œæ•°æ®ä¼ è¾“ã€‚å› ä¸ºæˆ‘ä»¬å¸Œæœ›è®¡ç®—æ—¶é—´æ¯”æƒé‡åŠ è½½æ—¶é—´é•¿ï¼Œå‡è®¾æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰æƒé‡åŠ è½½ä¸è®¡ç®—é‡å ï¼Œæˆ‘ä»¬å¸Œæœ› <d-math>2BDF / 9.2e14 &gt; 2 \cdot (BD + DF + BF) / 1.5e10</d-math>ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„å‡è®¾ <d-math>B \ll D</d-math>ï¼Œå’Œ <d-math>F = 4D</d-math> æ¥ç®€åŒ–è¿™ä¸ªä¸ç­‰å¼ï¼Œå¾—åˆ°</p> <mjx-container class="MathJax CtxtMenu_Attached_0" ctxtmenu_counter="0" display="true" jax="CHTML" style="font-size: 116.9%; position: relative;" tabindex="0"><mjx-math aria-hidden="true" class="MJX-TEX" display="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D437 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D437 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math><mjx-assistive-mml display="block" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mn>8</mn><mi>B</mi><msup><mi>D</mi><mn>2</mn></msup></mrow><mrow><mn>9.2</mn><mi>e</mi><mn>14</mn></mrow></mfrac><mo>&gt;</mo><mfrac><mrow><mn>8</mn><msup><mi>D</mi><mn>2</mn></msup></mrow><mrow><mn>1.5</mn><mi>e</mi><mn>10</mn></mrow></mfrac></math></mjx-assistive-mml></mjx-container> <p>æˆ–è€…</p> <mjx-container class="MathJax CtxtMenu_Attached_0" ctxtmenu_counter="1" display="true" jax="CHTML" style="font-size: 116.9%; position: relative;" tabindex="0"><mjx-math aria-hidden="true" class="MJX-TEX" display="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2243"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display="block" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi><mo>&gt;</mo><mfrac><mrow><mn>9.2</mn><mi>e</mi><mn>14</mn></mrow><mrow><mn>1.5</mn><mi>e</mi><mn>10</mn></mrow></mfrac><mo>â‰ƒ</mo><mn>61</mn><mo>,</mo><mn>000</mn></math></mjx-assistive-mml></mjx-container> </details> <p><strong>é—®é¢˜4 [é€šç”¨çŸ©é˜µä¹˜æ³•å»¶è¿Ÿ]ï¼š</strong>å‡è®¾æˆ‘ä»¬æƒ³å°†ä¸€ä¸ªæƒé‡çŸ©é˜µint8[16384, 4096]ä¸ä¸€ä¸ªå¤§å°ä¸ºint8[B, 4096]çš„æ¿€æ´»çŸ©é˜µç›¸ä¹˜ï¼Œå…¶ä¸­Bæ˜¯æŸä¸ªæœªçŸ¥çš„æ‰¹é‡å¤§å°ã€‚å‡è®¾æˆ‘ä»¬å¼€å§‹æ—¶åœ¨ä¸€ä¸ªTPUv5eä¸Šã€‚</p> <ol> <li>è¿™æ¬¡ä¹˜æ³•ä½œä¸ºBçš„å‡½æ•°å°†è€—æ—¶å¤šä¹…ï¼Ÿ<em>æç¤ºï¼šè®¡ç®—ä»HBMåŠ è½½æ•°ç»„æ‰€éœ€çš„æ—¶é—´å’Œå®é™…ä¹˜æ³•æ‰€éœ€çš„æ—¶é—´å¯èƒ½ä¼šæœ‰å¸®åŠ©ã€‚å“ªä¸ªæ˜¯ä½ çš„ç“¶é¢ˆï¼Ÿ</em> </li> <li>å¦‚æœæˆ‘ä»¬æƒ³ä»VMEMä¸­è¿è¡Œè¿™ä¸ªæ“ä½œå‘¢ï¼Ÿä½œä¸ºBçš„å‡½æ•°å®ƒå°†è€—æ—¶å¤šä¹…ï¼Ÿ</li> </ol> <details><summary>ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹ç­”æ¡ˆã€‚</summary> <p><strong>ç­”æ¡ˆï¼š</strong>(1) æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„æµ®ç‚¹è¿ç®—æ¬¡æ•°æ˜¯ <d-math>2 \cdot 4096 \cdot 16384 \cdot B = 1.3e8 \cdot B</d-math>ã€‚æ‰€ä»¥ <d-math>T_{\text{math}} = (1.3e8 \cdot B) / 3.94e14</d-math> ç§’ã€‚æˆ‘ä»¬éœ€è¦ä»HBMåŠ è½½ <d-math>16384 \cdot 4096 + 4096 \cdot B</d-math> å­—èŠ‚åˆ°VMEMï¼Œå¹¶å°† <d-math>16384 \cdot B</d-math> å­—èŠ‚ä»VMEMå†™å›HBMã€‚è¿™æ„å‘³ç€ <d-math>T_{\text{comms}} = (6.7e7 + 2e4\cdot B) / 8.1e11</d-math> ç§’ã€‚å‡è®¾é€šä¿¡å’Œè®¡ç®—å°½å¯èƒ½é‡å ï¼Œæ•´ä¸ªä¹˜æ³•å°†å¤§çº¦è€—æ—¶</p> <mjx-container class="MathJax CtxtMenu_Attached_0" ctxtmenu_counter="2" display="true" jax="CHTML" style="font-size: 116.9%; position: relative;" tabindex="0"><mjx-math aria-hidden="true" class="MJX-TEX" display="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.12em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c68"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.12em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c73"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mo><mjx-mrow space="2"><mjx-mo class="mjx-s3"><mjx-c class="mjx-c7B TEX-S3"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mfrac space="2"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-s3"><mjx-c class="mjx-c7D TEX-S3"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml display="block" unselectable="on"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP" movablelimits="true">max</mo><mo fence="false" stretchy="false">{</mo><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mtext>math</mtext></mrow></msub><mo>,</mo><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mtext>comms</mtext></mrow></msub><mo fence="false" stretchy="false">}</mo><mo>=</mo><mo data-mjx-texclass="OP" movablelimits="true">max</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">{</mo><mfrac><mrow><mn>6.7</mn><mi>e</mi><mn>7</mn><mo>+</mo><mn>2</mn><mi>e</mi><mn>4</mn><mo>â‹…</mo><mi>B</mi></mrow><mrow><mn>8.1</mn><mi>e</mi><mn>11</mn></mrow></mfrac><mo>,</mo><mfrac><mrow><mn>1.3</mn><mi>e</mi><mn>8</mn><mo>â‹…</mo><mi>B</mi></mrow><mrow><mn>3.94</mn><mi>e</mi><mn>14</mn></mrow></mfrac><mo data-mjx-texclass="CLOSE">}</mo></mrow></math></mjx-assistive-mml></mjx-container> <p>å½“ <d-math>\frac{6.7e7 + 2e4\cdot B}{8.1e11} &lt; \frac{1.3e8 \cdot B}{3.94e14}</d-math> æ—¶ï¼Œæˆ‘ä»¬å°†å—é™äºFLOPsï¼Œæˆ–è€…ç­‰ä»·åœ°ï¼Œ<d-math>B &gt; 271</d-math>ã€‚è¿™ä¸ªæ•°å­—æ¯”æˆ‘ä»¬ä¸‹é¢æ¨å¯¼å‡ºçš„240ç•¥å¤§ï¼Œå› ä¸ºæˆ‘ä»¬è€ƒè™‘äº† <mjx-container class="MathJax CtxtMenu_Attached_0" ctxtmenu_counter="3" jax="CHTML" style="font-size: 116.9%; position: relative;" tabindex="0"><mjx-math aria-hidden="true" class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D437 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display="inline" unselectable="on"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></mjx-assistive-mml></mjx-container> å’Œ <mjx-container class="MathJax CtxtMenu_Attached_0" ctxtmenu_counter="4" jax="CHTML" style="font-size: 116.9%; position: relative;" tabindex="0"><mjx-math aria-hidden="true" class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml display="inline" unselectable="on"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi></math></mjx-assistive-mml></mjx-container> çš„å…¨éƒ¨å½±å“ã€‚</p> <p>(2) å¦‚æœæˆ‘ä»¬æ”¹ä¸ºä»VMEMåŠ è½½ï¼Œè®©æˆ‘ä»¬å°†VMEMåˆ°MXUçš„å¸¦å®½è§†ä¸ºHBM <d-math>\leftrightarrow</d-math> VMEMå¸¦å®½çš„22å€ã€‚è¿™å°†æˆ‘ä»¬çš„æ•°æ®åŠ è½½åˆ†æ¯ä»8.1e11å˜ä¸º1.78e13ï¼Œæˆ‘ä»¬å¾—åˆ° <d-math>B &gt; 11</d-math>ã€‚æ³¨æ„ï¼Œå®é™…ä¸Šï¼Œæˆ‘ä»¬ä¸èƒ½å°†æ‰€æœ‰VMEMå¸¦å®½éƒ½ç”¨äºåŠ è½½ <d-math>W</d-math>ï¼Œæ‰€ä»¥å®é™…ä¸Šå®ƒä¼šæ¥è¿‘20ã€‚</p> </details> <p><strong>é—®é¢˜5 [ICIå¸¦å®½]ï¼š</strong>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªTPU v5e <code class="language-plaintext highlighter-rouge">4x4</code> sliceã€‚æˆ‘ä»¬æƒ³å°†ä¸€ä¸ªç±»å‹ä¸º <code class="language-plaintext highlighter-rouge">bfloat16[8, 128, 8192]</code> çš„æ•°ç»„ä» <code class="language-plaintext highlighter-rouge">TPU{0,0}</code> å‘é€åˆ° <code class="language-plaintext highlighter-rouge">TPU{3, 3}</code>ã€‚å‡è®¾TPU v5eçš„æ¯è·³å»¶è¿Ÿæ˜¯ <d-math>1\mu s</d-math>ã€‚</p> <ol> <li>ç¬¬ä¸€ä¸ªå­—èŠ‚å°†å¤šå¿«åˆ°è¾¾ç›®çš„åœ°ï¼Ÿ</li> <li>æ€»ä¼ è¾“å°†è€—æ—¶å¤šä¹…ï¼Ÿ</li> </ol> <details><summary>ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹ç­”æ¡ˆã€‚</summary> <p><strong>ç­”æ¡ˆï¼š</strong>åœ¨TPUv5eä¸­ï¼Œæˆ‘ä»¬æœ‰2Dè¿æ¥ã€‚å› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">4x4</code> sliceï¼ˆæ²¡æœ‰å¤§å°ä¸º16çš„è½´ï¼‰ï¼Œæˆ‘ä»¬æ²¡æœ‰ç¯ç»•è¿æ¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç›®æ ‡èŠ¯ç‰‡å¯ä»¥ä»ä¸¤ä¸ªç«¯å£æ¥æ”¶æ•°æ®ï¼ŒåŒæ ·åœ°ï¼Œæˆ‘ä»¬çš„æºèŠ¯ç‰‡å¯ä»¥ä»ä¸¤ä¸ªç«¯å£å‘é€æ•°æ®ã€‚æˆ‘ä»¬éœ€è¦ä¼ è¾“çš„æ•°æ®é‡æ˜¯ <code class="language-plaintext highlighter-rouge">2 * 8 * 128 * 8192 = 1.7e7</code> å­—èŠ‚ã€‚æˆ‘ä»¬å¯ä»¥åŒæ—¶ä»ä¸¤ä¸ªç«¯å£ä¼ è¾“ï¼ˆå³ä¸€åŠæ•°ç»„å‘å³å‘é€ï¼Œä¸€åŠå‘ä¸‹å‘é€ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯ç§’ä¼ è¾“ <code class="language-plaintext highlighter-rouge">2 * 4.5e10 = 9e10</code> å­—èŠ‚ï¼Œè¿™æ„å‘³ç€ä¼ è¾“æ•´ä¸ªæ•°ç»„å¤§çº¦éœ€è¦ <code class="language-plaintext highlighter-rouge">1.7e7 / 9e10 = 188us</code>ï¼ˆå‡è®¾æˆ‘ä»¬å—é™äºå¸¦å®½ï¼‰ã€‚åœ¨ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">4x4</code> sliceä¸­ï¼ŒèŠ¯ç‰‡ <d-math>(0, 0)</d-math> å’Œ <d-math>(3, 3)</d-math> ä¹‹é—´æœ‰å…­æ¬¡è·³è·ƒï¼Œå› ä¸ºè½´ä¸Šå°‘äº16ä¸ªèŠ¯ç‰‡æ—¶æ²¡æœ‰ç¯ç»•é“¾è·¯ã€‚ç”±äºæ¯è·³çš„å»¶è¿Ÿå¤§çº¦æ˜¯ <d-math>1\mu s</d-math>ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚å°†åœ¨å¤§çº¦<code class="language-plaintext highlighter-rouge">6us</code>åˆ°è¾¾ï¼Œæ€»ä¼ è¾“å°†è€—æ—¶<code class="language-plaintext highlighter-rouge">188us</code>ã€‚</p> </details> <p><strong>é—®é¢˜6 [ç»¼åˆç»ƒä¹ ï¼Œè¾ƒéš¾]ï¼š</strong>æƒ³è±¡ä½ æœ‰ä¸€ä¸ªå¤§çŸ©é˜µ <strong>A</strong>ï¼š<code class="language-plaintext highlighter-rouge">int8[128 * 1024, 128 * 1024]</code> å‡åŒ€åˆ†ç‰‡åœ¨ä¸€ä¸ªTPU v5e 4x4 sliceä¸Šï¼Œä½†å¸è½½åˆ°æ¯ä¸ªèŠ¯ç‰‡çš„ä¸»æœºDRAMä¸­ã€‚å‡è®¾ä½ æƒ³å°†æ•´ä¸ªæ•°ç»„å¤åˆ¶åˆ°TPU{0, 0}å¹¶å°†å…¶ä¸ä¸€ä¸ªå‘é‡ <code class="language-plaintext highlighter-rouge">bf16[8, 128 * 1024]</code> ç›¸ä¹˜ã€‚è¿™å°†è€—æ—¶å¤šä¹…ï¼Ÿ<em>æç¤ºï¼šä½¿ç”¨ä¸Šé¢çš„æ•°å­—ã€‚</em></p> <details><summary>ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹ç­”æ¡ˆã€‚</summary> <p><strong>ç­”æ¡ˆï¼š</strong>è®©æˆ‘ä»¬é¦–å…ˆæ¦‚è¿°ä¸€ä¸‹æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„æ“ä½œã€‚æˆ‘ä»¬çš„æ•°ç»„å¤§çº¦æ˜¯16GBã€‚ä»ä¸Šè¡¨ä¸­ï¼Œä¸€ä¸ªTPU v5eä¸»æœºæœ‰4x2çš„æ‹“æ‰‘ï¼Œæ‰€ä»¥ä¸€ä¸ª4x4æœ‰2ä¸ªä¸»æœºã€‚å› æ­¤ï¼Œç”±äºæˆ‘ä»¬çš„æ•°ç»„æ˜¯å‡åŒ€åˆ†ç‰‡çš„ï¼Œæ¯ä¸ªä¸»æœºå®é™…ä¸ŠåŒ…å«æ•°ç»„çš„1/2ï¼Œå³8GBã€‚æˆ‘ä»¬éœ€è¦å°†è¿™äº›å—å…¨éƒ¨å¤åˆ¶åˆ°TPU{0,0}ï¼Œè¿™ç»™äº†æˆ‘ä»¬ä¸¤ä¸ªé€‰æ‹©ï¼š</p> <ol> <li>æˆ‘ä»¬å¯ä»¥é€šè¿‡DCNå¤åˆ¶ï¼Œç„¶åé€šè¿‡PCIeå°†æ•´ä¸ªæœªåˆ†ç‰‡çš„æ•°ç»„åŠ è½½åˆ°HBMä¸­ã€‚</li> <li>æˆ‘ä»¬å¯ä»¥å°†åˆ†ç‰‡çš„æ•°ç»„åŠ è½½åˆ°å®ƒä»¬å¯¹åº”çš„TPUä¸Šï¼Œç„¶ååœ¨ICIä¸Šæ‰§è¡Œä¸€æ¬¡gatheræ“ä½œï¼Œæœ€ååœ¨TPU{0,0}ä¸Šæ‰§è¡ŒçŸ©é˜µä¹˜æ³•ã€‚</li> </ol> <p>å¾ˆæ˜æ˜¾ï¼Œé€‰é¡¹ï¼ˆ2ï¼‰æ›´å¥½ã€‚DCNæ¯”ICIæ…¢ï¼Œè€Œä¸”æˆ‘ä»¬æ›´æ„¿æ„é€šè¿‡å¤šä¸ªPCIeé“¾è·¯åŠ è½½ä¸€ä¸ªå¤§æ•°ç»„ï¼Œè€Œä¸æ˜¯ä»…ä»…é€šè¿‡å°‘æ•°å‡ ä¸ªï¼ˆä¸»æœº0ä¸Šçš„8ä¸ªï¼‰ã€‚è¿™æ˜¯ç³»ç»Ÿéƒ¨åˆ†ç¤ºæ„å›¾ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œè¯·æ³¨æ„TPUé€šè¿‡ICIè¿æ¥åˆ°å®ƒä»¬çš„é‚»å±…ï¼ˆå³ä½¿è·¨ä¸»æœºï¼‰ï¼Œæ‰€æœ‰TPUéƒ½é€šè¿‡PCIeè¿æ¥åˆ°å®ƒä»¬çš„ä¸»æœºCPUï¼Œè€Œä¸»æœºä¹‹é—´é€šè¿‡DCNè¿æ¥ã€‚</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/challenge-problem-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/challenge-problem-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/challenge-problem-1400.webp 1400w" type="image/webp"/> <img class="img-fluid img-small" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/challenge-problem.png" width="100%"/> </picture> <figcaption class="caption">æ¯ä¸ªèŠ¯ç‰‡å®é™…ä¸Šéƒ½æœ‰è‡ªå·±çš„PCIeé“¾è·¯è¿æ¥åˆ°å…¶ä¸»æœºï¼Œä½†ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè¿™é‡Œåªæ˜¾ç¤ºäº†ä¸€ä¸ªã€‚</figcaption> </figure> <p>ç°åœ¨è®©æˆ‘ä»¬è®¡ç®—æ¯ä¸ªéƒ¨åˆ†å°†è€—æ—¶å¤šä¹…ï¼š</p> <ol> <li> <p><strong>PCIeåŠ è½½</strong>ï¼šæˆ‘ä»¬é€šè¿‡16ä¸ªPCIeé“¾è·¯åŠ è½½16GB / 2 = 8GBçš„å—ï¼Œæ¯ä¸ªé“¾è·¯çš„å¸¦å®½ä¸º <code class="language-plaintext highlighter-rouge">1.5e10</code> å­—èŠ‚/ç§’ã€‚å› æ­¤ï¼Œè¿™å°†è€—æ—¶çº¦33æ¯«ç§’ã€‚</p> </li> <li> <p><strong>ICIå¤åˆ¶ï¼š</strong>æ¯ä¸ªTPUç°åœ¨æ‹¥æœ‰æˆ‘ä»¬æ•°ç»„çš„16GB / 16 = 1GBã€‚æˆ‘ä»¬çš„ICIå¸¦å®½æ˜¯æ¯ä¸ªé“¾è·¯<em>åŒå‘</em>9e10å­—èŠ‚/ç§’ï¼Œä½ ä¼šä»ä¸Šå›¾ä¸­æ³¨æ„åˆ°ï¼Œåœ¨è¿™ä¸ªæ‹“æ‰‘ä¸­ï¼ŒTPU v5eä¸Š4ä¸ªICIé“¾è·¯ä¸­åªæœ‰2ä¸ªè¢«TPU{0,0}ä½¿ç”¨ã€‚ç”±äºTPU{0,0}éœ€è¦æ²¿ç€2ä¸ªè½´ä»¥ <code class="language-plaintext highlighter-rouge">4.5e10</code> å­—èŠ‚/ç§’/é“¾è·¯çš„é€Ÿåº¦æ¥æ”¶æ€»å…±15GBçš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ—¶é—´ä¸‹ç•Œé™å®šä¸º <code class="language-plaintext highlighter-rouge">15e9 / (4.5e10 * 2) = 167ms</code>ã€‚å®é™…ä¸Šï¼Œè¿™å¯èƒ½æ— æ³•å®ç°ï¼Œå› ä¸ºè´Ÿè½½éå¸¸ä¸å‡åŒ€ï¼Œä½†å¯èƒ½åœ¨2å€çš„å› å­å†…ã€‚æ­£å¦‚ä½ å°†åœ¨ç¬¬2èŠ‚ä¸­çœ‹åˆ°çš„ï¼Œæ‰§è¡Œä¸€ä¸ªå®Œæ•´çš„AllGatherä¹Ÿå¤§çº¦éœ€è¦ <code class="language-plaintext highlighter-rouge">16e9 / (4.5e10 * 2)</code>ï¼Œæ‰€ä»¥è¿™æ¥è¿‘æœ€ä¼˜ã€‚</p> </li> <li> <p><strong>HBM <d-math>\rightarrow</d-math> MXUåŠ è½½ï¼š</strong>ä¸ºäº†æ‰§è¡Œæˆ‘ä»¬æœ€åçš„çŸ©é˜µä¹˜æ³•ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™16e9å­—èŠ‚åŠ ä¸Šbf16[8, 128 * 1024]æ•°ç»„ï¼ˆå¦å¤–2MBï¼Œå¯å¿½ç•¥ä¸è®¡ï¼‰é€šè¿‡HBMå¸¦å®½åŠ è½½åˆ°MXUä¸­ï¼Œè¿™å°†è€—æ—¶ <code class="language-plaintext highlighter-rouge">16e9 / 8.1e11 = 19ms</code>ã€‚</p> </li> <li> <p><strong>FLOPsï¼š</strong>æˆ‘ä»¬æ€»å…±æ‰§è¡Œ <mjx-container class="MathJax CtxtMenu_Attached_0" ctxtmenu_counter="5" jax="CHTML" style="font-size: 116.9%; position: relative;" tabindex="0"><mjx-math aria-hidden="true" class="MJX-TEX"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c38"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c37"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml display="inline" unselectable="on"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mo>â‹…</mo><mn>8</mn><mo>â‹…</mo><mn>128</mn><mo>â‹…</mo><mn>1024</mn><mo>â‹…</mo><mn>128</mn><mo>â‹…</mo><mn>1024</mn><mo>=</mo><mn>2.7</mn><mi>e</mi><mn>11</mn></math></mjx-assistive-mml></mjx-container> FLOPsï¼Œç”±äºæˆ‘ä»¬å¯ä»¥æ‰§è¡Œ <code class="language-plaintext highlighter-rouge">1.97e14</code> bf16 FLOPs/sï¼Œæˆ‘ä»¬å¾—åˆ°1.3æ¯«ç§’ã€‚</p> </li> </ol> <p>æ€»æ—¶é—´çš„ä¸Šé™æ˜¯æ‰€æœ‰è¿™äº›æ—¶é—´çš„æ€»å’Œï¼Œä½†ç”±äºTPUé€šå¸¸å¯ä»¥é‡å è¿™äº›æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºä¸€ä¸ªç”±æœ€æ…¢éƒ¨åˆ†å†³å®šçš„æµæ°´çº¿é—®é¢˜ã€‚å¦‚æœè¿™æ˜¯çœŸçš„ï¼Œé‚£ä¹ˆç­”æ¡ˆå¤§çº¦æ˜¯150-200æ¯«ç§’ã€‚</p> </details> <h3 class="next-section">ç¬¬2éƒ¨åˆ†åˆ°æ­¤ç»“æŸï¼å…³äºç¬¬3éƒ¨åˆ†ï¼Œæ¶µç›–åˆ†åŒºå’Œè·¨TPUé€šä¿¡ï¼Œè¯·<a href="sharding.html">ç‚¹å‡»è¿™é‡Œ</a>ã€‚</h3> <h2 id="appendix">é™„å½•</h2> <h3 id="appendix-a-more-on-tpu-internals">é™„å½•Aï¼šæ›´å¤šå…³äºTPUå†…éƒ¨çš„ç»†èŠ‚</h3> <p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°æ¢è®¨TPUçš„å†…éƒ¨æ“ä½œã€‚é™¤éå¦æœ‰è¯´æ˜ï¼Œæˆ‘ä»¬å°†æä¾›TPU v5pçš„è§„æ ¼ã€‚</p> <h3 id="vpu">VPU</h3> <p>VPUæ˜¯TPUçš„å‘é‡ç®—æœ¯æ ¸å¿ƒã€‚VPUç”±ä¸€ä¸ªäºŒç»´SIMDå‘é‡æœºï¼ˆ<strong>VPU</strong>ï¼‰ç»„æˆï¼Œè¯¥å‘é‡æœºæ‰§è¡Œé€å…ƒç´ ç®—æœ¯è¿ç®—ï¼Œå¦‚vaddï¼ˆå‘é‡åŠ æ³•ï¼‰æˆ–vmaxï¼ˆé€å…ƒç´ æœ€å¤§å€¼ï¼‰ï¼Œä»¥åŠä¸€ç»„ç§°ä¸º<strong>VREGs</strong>çš„å‘é‡å¯„å­˜å™¨ï¼Œç”¨äºä¸ºVPUå’ŒMXUä¿å­˜æ•°æ®ã€‚</p> <p><strong>VREGsï¼š</strong>æ¯ä¸ªTPU v5pæ ¸å¿ƒæœ‰64ä¸ª32ä½VREGsï¼ˆTPU v4ä¸º32ä¸ªï¼‰ï¼Œè¿™ç»™äº†æˆ‘ä»¬æ¯ä¸ªæ ¸å¿ƒæ€»å…±çº¦ <code class="language-plaintext highlighter-rouge">64 * 8 * 128 * 4 = 256kB</code> çš„VREGå†…å­˜ï¼ˆå¯¹äºæ•´ä¸ªèŠ¯ç‰‡æ¥è¯´æ˜¯è¿™ä¸ªå€¼çš„2å€ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ ¸å¿ƒï¼‰ã€‚ä¸€ä¸ªTPU v5pæ¯ä¸ªå‘¨æœŸå¯ä»¥ä»VMEMåŠ è½½3ä¸ªå¯„å­˜å™¨ï¼Œå¹¶å‘VMEMå†™å…¥1ä¸ªå¯„å­˜å™¨ã€‚</p> <p><strong>VPUï¼š</strong>VPUæ˜¯ä¸€ä¸ªå½¢çŠ¶ä¸º <code class="language-plaintext highlighter-rouge">(8, 128)</code> çš„äºŒç»´å‘é‡ç®—æœ¯å•å…ƒï¼Œå…¶ä¸­128ç»´è¢«ç§°ä¸ºlaneè½´ï¼Œ8ç»´è¢«ç§°ä¸ºsublaneè½´ã€‚åœ¨v5ä¸Šï¼Œæ¯ä¸ªï¼ˆlane, sublaneï¼‰å¯¹åŒ…å«4ä¸ªç›¸äº’ç‹¬ç«‹çš„æ ‡å‡†æµ®ç‚¹ALUã€‚VPUåœ¨å…¶æ¯ä¸ªALUä¸­ç”¨ä¸€ä¸ªå‘¨æœŸæ‰§è¡Œå¤§å¤šæ•°ç®—æœ¯æŒ‡ä»¤ï¼ˆå¦‚vaddæˆ–å‘é‡åŠ æ³•ï¼‰ï¼Œå»¶è¿Ÿä¸º2ä¸ªå‘¨æœŸï¼Œæ‰€ä»¥ä¾‹å¦‚åœ¨v5ä¸­ï¼Œä½ æ¯ä¸ªå‘¨æœŸå¯ä»¥ä»VREGsä¸­å°†4å¯¹f32å€¼ç›¸åŠ ã€‚ä¸€ä¸ªå…¸å‹çš„VPUæŒ‡ä»¤å¯èƒ½çœ‹èµ·æ¥åƒ <code class="language-plaintext highlighter-rouge">{v2 = vadd.8x128.f32 v0, v1}</code>ï¼Œå…¶ä¸­v0å’Œv1æ˜¯è¾“å…¥VREGsï¼Œv2æ˜¯è¾“å‡ºVREGã€‚</p> <p>æ‰€æœ‰laneå’Œsublaneéƒ½ä»¥çº¯ç²¹çš„SIMDæ–¹å¼æ¯ä¸ªå‘¨æœŸæ‰§è¡Œç›¸åŒçš„ç¨‹åºï¼Œä½†æ¯ä¸ªALUå¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªå‘¨æœŸå†…å¤„ç†1ä¸ªvaddå’Œ1ä¸ªvsubï¼Œæ¯ä¸ªéƒ½ä½œç”¨äºä¸¤ä¸ªå®Œæ•´çš„VREGså¹¶å°†è¾“å‡ºå†™å…¥ç¬¬ä¸‰ä¸ªã€‚</p> <p><strong>å°æµ‹éªŒ [è®¡ç®—VPUååé‡]ï¼š</strong>ä½¿ç”¨ä»¥ä¸Šä¿¡æ¯ï¼Œè®¡ç®—ä¸€ä¸ªTPU v5på¯ä»¥æ‰§è¡Œå¤šå°‘å‘é‡FLOPs/sã€‚ä¸€ä¸ªTPU v5pçš„æ—¶é’Ÿé€Ÿåº¦çº¦ä¸º1.75GHzã€‚</p> <details><summary>ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹ç­”æ¡ˆã€‚</summary> <p><em>ç­”æ¡ˆ</em>ï¼šæ¯ä¸ªå‘¨æœŸï¼Œæ¯ä¸ªæ ¸å¿ƒå¯ä»¥åœ¨ <code class="language-plaintext highlighter-rouge">8 * 128</code> ä¸ªALUä¸Šæ‰§è¡Œ4ä¸ªå‘é‡æŒ‡ä»¤ã€‚è¿™ç»™äº†æˆ‘ä»¬æ•´ä¸ªèŠ¯ç‰‡æ¯ä¸ªå‘¨æœŸ <code class="language-plaintext highlighter-rouge">8 * 128 * 4 * 2</code> FLOPsï¼Œæˆ–è€… <code class="language-plaintext highlighter-rouge">8 * 128 * 4 * 2 * 1.75e9 = 1.4e13 FLOPs/s</code>ã€‚æ³¨æ„è¿™æ¯”MXUçš„FLOPs/sï¼ˆçº¦<code class="language-plaintext highlighter-rouge">2e14</code>ï¼‰å°å¤šå°‘ï¼ˆå¤§çº¦10å€ï¼‰ã€‚</p> </details> <p><strong>å½’çº¦ï¼š</strong>é€šå¸¸ï¼Œè·¨sublaneç»´åº¦çš„é€šä¿¡æˆ–å½’çº¦æ¯”è·¨laneç»´åº¦çš„è¦å®¹æ˜“ã€‚ä¾‹å¦‚ï¼ŒVPUæ”¯æŒä¸€ä¸ªlaneå†…shuffleæ“ä½œï¼Œå¯ä»¥åœ¨å¤§å°ä¸º8çš„è½´ä¸Šå¤§çº¦ä¸€ä¸ªå‘¨æœŸå†…æ»šåŠ¨ã€‚è¿™å¯ä»¥ç”¨æ¥åœ¨sublaneç»´åº¦ä¸Šæ‰§è¡Œé«˜æ•ˆçš„å½’çº¦ï¼ˆåªéœ€æŒ‰4ã€2å’Œ1è¿›è¡Œshuffleï¼Œå¹¶è¿›è¡Œ3å¯¹é€å…ƒç´ æ±‚å’Œï¼‰ã€‚</p> <p>è·¨laneå½’çº¦è¦å›°éš¾å¾—å¤šï¼Œå¹¶ä¸”æ¶‰åŠä¸€ä¸ªç§°ä¸ºXLUæˆ–â€œè·¨laneå•å…ƒâ€çš„ç‹¬ç«‹ç¡¬ä»¶å•å…ƒï¼Œå®ƒåˆæ…¢åˆç›¸å½“æ˜‚è´µã€‚</p> <p><strong>ä¸GPUçš„æ¯”è¾ƒï¼š</strong>å¯¹äºç†Ÿæ‚‰NVIDIA GPUçš„äººæ¥è¯´ï¼ŒVPUä¸­çš„æ¯ä¸ªALUç±»ä¼¼äºä¸€ä¸ªCUDAæ ¸å¿ƒï¼Œè€Œä¸€ä¸ªVPU laneç±»ä¼¼äºä¸€ä¸ªâ€œWarp Schedulerâ€ï¼Œå³é€šå¸¸æ‰§è¡ŒSIMDç®—æœ¯çš„32ä¸ªCUDAæ ¸å¿ƒçš„é›†åˆã€‚åœ¨laneå†…çš„å½’çº¦ç›¸å½“å®¹æ˜“ï¼Œä½†å¦‚æœæˆ‘ä»¬éœ€è¦è·¨laneï¼Œæˆ‘ä»¬è‡³å°‘éœ€è¦é€šè¿‡VMEM/XLU/SMEMï¼Œè¿™è¦æ…¢å¾—å¤šã€‚æ›´å¤šç»†èŠ‚è¯·å‚è§<a href="gpus.html">GPUéƒ¨åˆ†</a>ã€‚</p> <h3 id="scalar-core">æ ‡é‡æ ¸å¿ƒ</h3> <p>æ ‡é‡æ ¸å¿ƒæ˜¯TPUçš„æ§åˆ¶å•å…ƒã€‚å®ƒè·å–å¹¶åˆ†æ´¾æ‰€æœ‰æŒ‡ä»¤ï¼Œæ‰§è¡Œä»HBMåˆ°VMEMçš„ä¼ è¾“ï¼Œå¹¶ä¸”å¯ä»¥ç¼–ç¨‹æ¥åšæ ‡é‡å…ƒæ•°æ®å·¥ä½œã€‚ç”±äºæ ‡é‡æ ¸å¿ƒæ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™å¸¦æ¥çš„ä¸€ä¸ªå‰¯ä½œç”¨æ˜¯TPUçš„æ¯ä¸ªæ ¸å¿ƒæ¯ä¸ªå‘¨æœŸåªèƒ½åˆ›å»ºä¸€ä¸ªDMAè¯·æ±‚ã€‚</p> <p>å…·ä½“æ¥è¯´ï¼Œä¸€ä¸ªæ ‡é‡æ ¸å¿ƒæ§åˆ¶ç€ä¸€ä¸ªVPUï¼ˆç”±4096ä¸ªALUç»„æˆï¼‰ã€4ä¸ªMXUã€2ä¸ªXLUå’Œå¤šä¸ªDMAå¼•æ“ã€‚è¿™ç§æ¯ä¸ªè®¡ç®—å•å…ƒæ§åˆ¶çš„é«˜åº¦å€¾æ–œç‰¹æ€§æ˜¯ç¡¬ä»¶æ•ˆç‡çš„æ¥æºï¼Œä½†ä¹Ÿé™åˆ¶äº†ä»¥ä»»ä½•æœ‰è¶£çš„æ–¹å¼è¿›è¡Œæ•°æ®ä¾èµ–å‘é‡åŒ–çš„èƒ½åŠ›ã€‚</p> <h3 id="appendix-b-how-does-a-systolic-array-work">é™„å½•Bï¼šè„‰åŠ¨é˜µåˆ—æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h3> <p>TPU MXUçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">128x128</code> è„‰åŠ¨é˜µåˆ—ï¼ˆTPU v6eä¸Šä¸º <code class="language-plaintext highlighter-rouge">256x256</code>ï¼‰ã€‚å½“å®Œå…¨é¥±å’Œæ—¶ï¼Œè„‰åŠ¨é˜µåˆ—å¯ä»¥æ¯8ä¸ªæ—¶é’Ÿå‘¨æœŸæ‰§è¡Œä¸€æ¬¡ <code class="language-plaintext highlighter-rouge">bfloat16[8,128] @ bf16[128x128] -&gt; f32[8,128]</code><d-footnote id="d-footnote-10">å¦‚æœä½ ä¸ç†Ÿæ‚‰è¿™ç§è¡¨ç¤ºæ³•ï¼Œå®ƒçš„æ„æ€æ˜¯ï¼šå°†ä¸€ä¸ª`8x128`çš„bfloat16å…ƒç´ çŸ©é˜µä¸ä¸€ä¸ª`128x128`çš„bfloat16å…ƒç´ çŸ©é˜µç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨ä¸€ä¸ª`8x128`çš„float32å…ƒç´ çŸ©é˜µä¸­ã€‚</d-footnote> ä¹˜æ³•ã€‚</p> <ul> <li>åœ¨å…¶æ ¸å¿ƒï¼Œè„‰åŠ¨é˜µåˆ—æ˜¯ä¸€ä¸ªäºŒç»´ <code class="language-plaintext highlighter-rouge">128x128</code> (<code class="language-plaintext highlighter-rouge">=16,384</code>) çš„ALUç½‘æ ¼ï¼Œæ¯ä¸ªALUéƒ½èƒ½æ‰§è¡Œä¹˜æ³•å’ŒåŠ æ³•æ“ä½œã€‚</li> <li>æƒé‡ï¼ˆ<strong>W</strong>ï¼Œå³ <code class="language-plaintext highlighter-rouge">128x128</code> è¾“å…¥ï¼‰ä»ä¸Šæ–¹ï¼ˆç§°ä¸ºRHSï¼‰ä¼ å…¥ï¼Œè€Œè¾“å…¥ï¼ˆ<strong>X</strong>ï¼Œå³ <code class="language-plaintext highlighter-rouge">8x128</code> è¾“å…¥ï¼‰ä»å·¦ä¾§ï¼ˆç§°ä¸ºLHSï¼‰ä¼ å…¥ã€‚</li> </ul> <p>è¿™æ˜¯ä¸€ä¸ªå°†ä¸€ç»„æƒé‡ï¼ˆè“è‰²ï¼‰ä¸ä¸€ç»„æ¿€æ´»ï¼ˆç»¿è‰²ï¼‰ç›¸ä¹˜çš„ç®€åŒ–åŠ¨ç”»ã€‚ä½ ä¼šæ³¨æ„åˆ°æƒé‡ï¼ˆRHSï¼‰é¦–å…ˆè¢«éƒ¨åˆ†åŠ è½½ï¼Œå‘ˆå¯¹è§’çº¿çŠ¶ï¼Œç„¶åæ¿€æ´»ä¹Ÿè¢«å¯¹è§’çº¿åœ°é€å…¥ã€‚åœ¨ä¸‹é¢çš„æ¯ä¸€å¸§ä¸­ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰é‡å çš„ç»¿è‰²å’Œè“è‰²å•å…ƒç›¸ä¹˜ï¼Œå°†ç»“æœä¸ä»ä¸Šæ–¹ä¼ å…¥çš„ä»»ä½•æ®‹å·®ç›¸åŠ ï¼Œç„¶åå°†ç»“æœä¾æ¬¡å‘ä¸‹ä¸€ä¸ªå•å…ƒä¼ é€’ã€‚</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/systolic-array-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/systolic-array-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/systolic-array-1400.webp 1400w" type="image/webp"/> <img height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/systolic-array.gif" width="100%"/> </picture> </figure> <p>è¿™æ˜¯ä¸€ä¸ªæ›´é€šç”¨çš„ç‰ˆæœ¬åŠ¨ç”»ï¼Œå±•ç¤ºäº†è¾“å‡ºå¦‚ä½•ä»è®¡ç®—ä¸­æµå‡ºï¼š</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/systolic-array2-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/systolic-array2-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/systolic-array2-1400.webp 1400w" type="image/webp"/> <img class="img-small" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/systolic-array2.gif" width="100%"/> </picture> </figure> <p>è¿™æ˜¯ä¸€ä¸ªå±•ç¤ºäº†å¦‚ä½•åœ¨å¤šä¸ªRHSå’ŒLHSæ•°ç»„ä¹‹é—´è¿›è¡Œæµæ°´çº¿æ“ä½œçš„å›¾è¡¨ï¼š</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/systolic-array-pipelining-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/systolic-array-pipelining-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/systolic-array-pipelining-1400.webp 1400w" type="image/webp"/> <img class="img-fluid" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/systolic-array-pipelining.png" width="100%"/> </picture> </figure> <p>åœ¨åŠ è½½æƒé‡ï¼ˆRHSï¼‰å’Œæ¿€æ´»ï¼ˆLHSï¼‰æ—¶å­˜åœ¨ä¸€ä¸ªåˆå§‹çš„æµæ°´çº¿æ°”æ³¡ã€‚åœ¨é‚£ä¸ªåˆå§‹æ°”æ³¡ä¹‹åï¼Œå¯ä»¥åŠ è½½æ–°çš„è¾“å…¥å’Œæƒé‡è€Œæ— éœ€é¢å¤–çš„æ°”æ³¡ã€‚</p> <p>è¿™æ˜¯ä¸€ä¸ªbf16[2, 3] x bf16[3, 3]çŸ©é˜µä¹˜æ³•çš„æ‹™åŠ£åŠ¨ç”»ï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ª2x3çš„æƒé‡çŸ©é˜µä¸ä¸€ä¸ªæ‰¹é‡ä¸º1ã€å¤§å°ä¸º3çš„è¾“å…¥æ¿€æ´»çš„çŸ©é˜µä¹˜æ³•ã€‚è¿™ä¸ªåŠ¨ç”»ä¸å‰é¢çš„å¹»ç¯ç‰‡ç›¸æ¯”æ˜¯æ—‹è½¬çš„ï¼Œè¾“å…¥å‘å³æµå‡ºè€Œä¸æ˜¯å‘ä¸‹ï¼Œä½†ä½ å¤§è‡´å¯ä»¥çœ‹åˆ°ç»“æ„ã€‚</p> <figure> <picture> <source class="responsive-img-srcset" sizes="95vw" srcset="https://jax-ml.github.io/scaling-book/assets/img/systolic-array-bad-480.webp 480w, https://jax-ml.github.io/scaling-book/assets/img/systolic-array-bad-800.webp 800w, https://jax-ml.github.io/scaling-book/assets/img/systolic-array-bad-1400.webp 1400w" type="image/webp"/> <img class="img-small" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();" src="https://jax-ml.github.io/scaling-book/assets/img/systolic-array-bad.gif" width="100%"/> </picture> </figure> <p>æˆ‘ä»¬å¯ä»¥é«˜æ•ˆåœ°å¯¹æ­¤è¿›è¡Œæµæ°´çº¿æ“ä½œï¼Œä»¥ä¹˜æ³•å¤§å‹çŸ©é˜µè€Œä¸ä¼šäº§ç”Ÿè¿‡å¤§çš„æµæ°´çº¿æ°”æ³¡ã€‚è¯è™½å¦‚æ­¤ï¼Œé‡è¦çš„æ˜¯æˆ‘ä»¬çš„çŸ©é˜µå½¢çŠ¶è¦å¤§äºMXUçš„è¾¹é•¿ï¼Œé€šå¸¸æ˜¯128x128ã€‚ä¸€äº›TPUï¼ˆè‡ªTPU v3èµ·ï¼‰æœ‰å¤šä¸ªMXUï¼ŒTPU v3æœ‰2ä¸ªï¼ŒTPU v4/5æœ‰4ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¡®ä¿åˆ†å—ç»´åº¦å¤§äº128 * MXUçš„æ•°é‡ã€‚<a href="https://www.youtube.com/watch?v=sJltBQ4MOHA" rel="external nofollow noopener" target="_blank">è¿™é‡Œ</a>æœ‰ä¸€ä¸ªå¾ˆå¥½çš„åŠ¨ç”»ã€‚</p> <p>Trilliumï¼ˆTPU v6eï¼‰æœ‰ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">256x256</code> è„‰åŠ¨é˜µåˆ—ï¼Œè¿™æ„å‘³ç€å®ƒæ¯å‘¨æœŸå¯ä»¥æ‰§è¡Œ4å€çš„FLOPsã€‚è¿™ä¹Ÿæ„å‘³ç€ä½ çš„å¼ é‡ç»´åº¦éœ€è¦æ˜¯åŸæ¥çš„ä¸¤å€å¤§æ‰èƒ½å……åˆ†åˆ©ç”¨MXUã€‚</p> <p><a href="https://fleetwood.dev/posts/domain-specific-architectures#google-tpu" rel="external nofollow noopener" target="_blank">è¿™ç¯‡åšå®¢æ–‡ç« </a>æœ‰å¦ä¸€ä¸ªå…³äºå›ºå®šæƒé‡çŸ©é˜µçš„è„‰åŠ¨é˜µåˆ—ä¹˜æ³•çš„æä½³åŠ¨ç”»ã€‚</p> </d-article> <d-appendix>
<style>

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

</style>
<d-footnote-list style="">
<style>

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}

</style>
<h3>è„šæ³¨</h3>
<ol><li id="d-footnote-1-listing">TPU v6e (Trillium) æœ‰ä¸€ä¸ª256x256çš„MXUï¼Œè€Œä¹‹å‰æ‰€æœ‰ä»£é™…éƒ½ä½¿ç”¨128x128<a class="footnote-backlink" href="#d-footnote-1">[â†©]</a></li><li id="d-footnote-2-listing">TPUï¼Œç‰¹åˆ«æ˜¯å…¶è„‰åŠ¨é˜µåˆ—ï¼Œä¹‹æ‰€ä»¥æ˜¯å¦‚æ­¤å¼ºå¤§çš„ç¡¬ä»¶åŠ é€Ÿå™¨ï¼Œæ˜¯å› ä¸ºçŸ©é˜µä¹˜æ³•æ˜¯å°‘æ•°å‡ ä¸ªä½¿ç”¨ <d-math>O(n^3)</d-math> è®¡ç®—é‡å¤„ç† <d-math>O(n^2)</d-math> å­—èŠ‚æ•°æ®çš„ç®—æ³•ä¹‹ä¸€ã€‚è¿™ä½¿å¾—æ™®é€šçš„ALUå¾ˆå®¹æ˜“å—è®¡ç®—è€Œéå†…å­˜å¸¦å®½çš„é™åˆ¶ã€‚<a class="footnote-backlink" href="#d-footnote-2">[â†©]</a></li><li id="d-footnote-3-listing">æˆ‘ä»¬æœ‰æ—¶ä¼šè°ˆåˆ°VMEMé¢„å–ï¼ŒæŒ‡çš„æ˜¯æå‰åœ¨VMEMä¸­åŠ è½½æƒé‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ©ç›–çŸ©é˜µä¹˜æ³•çš„åŠ è½½æˆæœ¬ã€‚ä¾‹å¦‚ï¼Œåœ¨æ ‡å‡†çš„Transformerä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶å¯ä»¥åœ¨æ³¨æ„åŠ›è®¡ç®—æœŸé—´å°†å¤§çš„å‰é¦ˆç½‘ç»œæƒé‡åŠ è½½åˆ°VMEMä¸­ï¼Œå¦‚æœæˆ‘ä»¬çš„å†…å­˜å¸¦å®½å—é™ï¼Œè¿™å¯ä»¥éšè—æƒé‡åŠ è½½çš„æˆæœ¬ã€‚è¿™è¦æ±‚æˆ‘ä»¬çš„æƒé‡è¶³å¤Ÿå°æˆ–åˆ†ç‰‡å¾—è¶³å¤Ÿç»†ï¼Œä»¥ä¾¿èƒ½å°†å•å±‚æƒé‡æ”¾å…¥VMEMå¹¶ç•™æœ‰ä½™åœ°ã€‚<a class="footnote-backlink" href="#d-footnote-3">[â†©]</a></li><li id="d-footnote-4-listing">åœ¨Cloud TPU VMä¸Šï¼Œæ¯ä¸ªæ‰˜ç›˜éƒ½ä½œä¸ºç‹¬ç«‹VMçš„ä¸€éƒ¨åˆ†æš´éœ²å‡ºæ¥ï¼Œå› æ­¤å†æ¬¡å¯è§4ä¸ªæ ¸å¿ƒã€‚<a class="footnote-backlink" href="#d-footnote-4">[â†©]</a></li><li id="d-footnote-5-listing">å…‰å­¦å¼€å…³åªæ˜¯ä¸€ä¸ªå…·æœ‰ç›¸åŒICIå¸¦å®½çš„å¯é‡æ„è¿æ¥ã€‚å®ƒåªæ˜¯è®©æˆ‘ä»¬åœ¨è¿æ¥ç«‹æ–¹ä½“çš„åŒæ—¶ä¿ç•™ç¯ç»•é“¾è·¯ã€‚<a class="footnote-backlink" href="#d-footnote-5">[â†©]</a></li><li id="d-footnote-6-listing">è¯·æ³¨æ„ï¼Œä¸€ä¸ª `2x2x4` ä¸ä¼šæœ‰ä»»ä½•ç¯ç»•è¿æ¥ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç”±å…‰å¼€å…³æä¾›çš„ï¼Œè€Œå…‰å¼€å…³åªåœ¨å®Œæ•´çš„ç«‹æ–¹ä½“ä¸Šå¯ç”¨ã€‚ç„¶è€Œï¼Œä¸€ä¸ªTPU v5e 8x16 _å°†_åœ¨è¾ƒé•¿çš„è½´ä¸Šæœ‰ç¯ç»•è¿æ¥ï¼Œå› ä¸ºå®ƒä¸ä½¿ç”¨å¯é‡æ„çš„å…‰ç½‘ç»œã€‚<a class="footnote-backlink" href="#d-footnote-6">[â†©]</a></li><li id="d-footnote-7-listing">ä¸Šè¿°é¡µé¢åˆ—å‡ºçš„å¸¦å®½ä¸º100 GB/sï¼Œä¸æ­¤å¤„åˆ—å‡ºçš„ç•¥æœ‰ä¸åŒã€‚TPU ICIé“¾è·¯çš„å¸¦å®½æ ¹æ®æ‰§è¡Œçš„æ“ä½œç•¥æœ‰ä¸åŒã€‚ä½ é€šå¸¸å¯ä»¥æ”¾å¿ƒä½¿ç”¨æœ¬æ–‡æ¡£ä¸­çš„æ•°å­—ã€‚<a class="footnote-backlink" href="#d-footnote-7">[â†©]</a></li><li id="d-footnote-8-listing">TPU v6eä¸º12.5e9å­—èŠ‚/ç§’ï¼Œv5eä¸º3.125e9å­—èŠ‚/ç§’ã€‚<a class="footnote-backlink" href="#d-footnote-8">[â†©]</a></li><li id="d-footnote-9-listing">æˆ‘ä»¬æ‰€è¯´çš„åŒå‘ï¼ˆbidiï¼‰å¸¦å®½æ˜¯æŒ‡å•ä¸ªé“¾è·¯ä¸ŠåŒå‘å¯å‘é€çš„æ€»å­—èŠ‚æ•°ï¼Œæˆ–è€…ç­‰åŒäºï¼Œå‡è®¾æˆ‘ä»¬å¯ä»¥é«˜æ•ˆåœ°ä½¿ç”¨ä¸¤ä¸ªé“¾è·¯ï¼Œå•ä¸ªTPUæ²¿ç‰¹å®šè½´çš„æ€»å‡ºå‘å­—èŠ‚æ•°ã€‚å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªåŠŸèƒ½æ­£å¸¸çš„ç¯å½¢ç½‘ç»œæ—¶ï¼Œå³å½“æˆ‘ä»¬åœ¨ç‰¹å®šè½´ä¸Šæœ‰ç¯ç»•è¿æ¥æ—¶ï¼Œè¿™æ˜¯æˆç«‹çš„ã€‚è¿™åœ¨æ¨ç†èŠ¯ç‰‡ä¸Šå½“æˆ‘ä»¬æœ‰ä¸€ä¸ªå®Œæ•´çš„16è½´æ—¶å‘ç”Ÿï¼Œæˆ–è€…åœ¨è®­ç»ƒèŠ¯ç‰‡ï¼ˆv*pï¼‰ä¸Šå½“æˆ‘ä»¬æœ‰ä¸€ä¸ªæ˜¯4çš„å€æ•°çš„è½´æ—¶å‘ç”Ÿã€‚æˆ‘ä»¬æ›´å–œæ¬¢ä½¿ç”¨åŒå‘å¸¦å®½ï¼Œå› ä¸ºå®ƒåœ¨æ¶‰åŠåŒå‘é€šä¿¡çš„è®¡ç®—ä¸­é¢‘ç¹å‡ºç°ã€‚<a class="footnote-backlink" href="#d-footnote-9">[â†©]</a></li><li id="d-footnote-10-listing">å¦‚æœä½ ä¸ç†Ÿæ‚‰è¿™ç§è¡¨ç¤ºæ³•ï¼Œå®ƒçš„æ„æ€æ˜¯ï¼šå°†ä¸€ä¸ª`8x128`çš„bfloat16å…ƒç´ çŸ©é˜µä¸ä¸€ä¸ª`128x128`çš„bfloat16å…ƒç´ çŸ©é˜µç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨ä¸€ä¸ª`8x128`çš„float32å…ƒç´ çŸ©é˜µä¸­ã€‚<a class="footnote-backlink" href="#d-footnote-10">[â†©]</a></li></ol>
</d-footnote-list> <d-citation-list style=""><style>
d-citation-list {
  contain: style;
}

d-citation-list .references {
  grid-column: text;
}

d-citation-list .references .title {
  font-weight: 500;
}
</style><h3 id="references">å‚è€ƒæ–‡çŒ®</h3><ol class="references" id="references-list"><li id="tpu_paper"><span class="title">TPU v4ï¼šä¸€ç§ç”¨äºæœºå™¨å­¦ä¹ çš„å…‰å­¦å¯é‡æ„è¶…çº§è®¡ç®—æœºï¼Œå…·æœ‰å¯¹åµŒå…¥çš„ç¡¬ä»¶æ”¯æŒ</span> <br/>Jouppi, N.P., Kurian, G., Li, S., Ma, P., Nagarajan, R., Nai, L., Patil, N., Subramanian, S., Swing, A., Towles, B., Young, C., Zhou, X., Zhou, Z. and Patterson, D., 2023. arXiv [cs.AR]. </li></ol></d-citation-list> <div class="base-grid appendix-entry"> <h3 style="grid-column: 0;">å…¶ä»–</h3> <p class="author-footnote" style="grid-column: text;"><sup>*</sup>å·¥ä½œäºGoogle DeepMindæœŸé—´å®Œæˆï¼Œç°å°±èŒäºMatXã€‚</p> </div> <div class="base-grid appendix-entry"> <h3 style="grid-column: 0;">å¼•ç”¨</h3> <p class="author-footnote">åœ¨å­¦æœ¯åœºåˆå¼•ç”¨ï¼Œè¯·æŒ‰ä»¥ä¸‹æ ¼å¼å¼•ç”¨æ­¤ä½œå“ï¼š</p> <div class="author-footnote"> <div class="language-bibtex highlighter-rouge"><div class="highlight"><div class="code-display-wrapper"><pre class="highlight"><code>    <span class="c">Austin et al., "How to Scale Your Model", Google DeepMind, online, 2025.</span>
</code></pre><button aria-label="Copy code to clipboard" class="copy" type="button"><i class="fa-solid fa-clipboard"></i></button></div></div></div> </div> <p class="author-footnote">æˆ–ä½¿ç”¨BibTeXæ¡ç›®ï¼š</p> <div class="author-footnote"> <div class="language-bibtex highlighter-rouge"><div class="highlight"><div class="code-display-wrapper"><pre class="highlight"><code>    <span class="nc">@article</span><span class="p">{</span><span class="nl">scaling-book</span><span class="p">,</span>
      <span class="na">title</span> <span class="p">=</span> <span class="s">{How to Scale Your Model}</span><span class="p">,</span>
      <span class="na">author</span> <span class="p">=</span> <span class="s">{Austin, Jacob and Douglas, Sholto and Frostig, Roy and Levskaya, Anselm and Chen, Charlie and Vikram, Sharad
      and Lebron, Federico and Choy, Peter and Ramasesh, Vinay and Webson, Albert and Pope, Reiner}</span><span class="p">,</span>
      <span class="na">publisher</span> <span class="p">=</span> <span class="s">{Google DeepMind}</span><span class="p">,</span>
      <span class="na">howpublished</span> <span class="p">=</span> <span class="s">{Online}</span><span class="p">,</span>
      <span class="na">note</span> <span class="p">=</span> <span class="s">{Retrieved from https://jax-ml.github.io/scaling-book/}</span><span class="p">,</span>
      <span class="na">year</span> <span class="p">=</span> <span class="s">{2025}</span>
    <span class="p">}</span>
</code></pre><button aria-label="Copy code to clipboard" class="copy" type="button"><i class="fa-solid fa-clipboard"></i></button></div></div></div> </div> </div> </d-appendix> <d-bibliography src="/scaling-book/assets/bibliography/main.bib"></d-bibliography> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'jax-ml/scaling-book',
        'data-repo-id': '',
        'data-category': 'General',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '0',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-loading': '1',
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script><script async="" crossorigin="anonymous" data-category="General" data-category-id="" data-emit-metadata="0" data-input-position="bottom" data-lang="en" data-loading="1" data-mapping="title" data-reactions-enabled="1" data-repo="jax-ml/scaling-book" data-repo-id="" data-strict="0" data-theme="light" src="https://giscus.app/client.js"></script><div class="giscus"><iframe allow="clipboard-write" class="giscus-frame giscus-frame--loading" scrolling="no" src="https://giscus.app/en/widget?origin=https%3A%2F%2Fjax-ml.github.io%2Fscaling-book%2Ftpus%2F&amp;session=&amp;theme=light&amp;reactionsEnabled=1&amp;emitMetadata=0&amp;inputPosition=bottom&amp;repo=jax-ml%2Fscaling-book&amp;repoId=&amp;category=General&amp;categoryId=&amp;strict=0&amp;description=This+section+is+all+about+how+TPUs+work%2C+how+they%27re+networked+together+to+enable+multi-chip+training+and+inference%2C+and+how+this+affects+the+performance+of+our+favorite+algorithms.+There%27s+even+some+good+stuff+for+GPU+users+too%21&amp;backLink=https%3A%2F%2Fjax-ml.github.io%2Fscaling-book%2Ftpus%2F&amp;term=How+to+Think+About+TPUs+%7C+How+To+Scale+Your+Model" style="opacity: 0;" title="Comments"></iframe></div> <noscript>è¯·å¯ç”¨JavaScriptä»¥æŸ¥çœ‹ç”±<a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">giscus</a>æ”¯æŒçš„è¯„è®ºã€‚ </noscript> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> Â© ç‰ˆæƒæ‰€æœ‰ 2025ã€‚ç”± <a href="https://jekyllrb.com/" rel="external nofollow noopener" target="_blank">Jekyll</a> å’Œ <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> ä¸»é¢˜å¼ºåŠ›é©±åŠ¨ã€‚æ‰˜ç®¡äº <a href="https://pages.github.com/" rel="external nofollow noopener" target="_blank">GitHub Pages</a>ã€‚ </div> </footer> <script crossorigin="anonymous" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script> <script src="https://jax-ml.github.io/scaling-book/assets/js/bootstrap.bundle.min.js"></script> <script crossorigin="anonymous" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js"></script> <script crossorigin="anonymous" defer="" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script> <script defer="" src="https://jax-ml.github.io/scaling-book/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://jax-ml.github.io/scaling-book/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer="" src="https://jax-ml.github.io/scaling-book/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer="" src="https://jax-ml.github.io/scaling-book/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer="" src="https://jax-ml.github.io/scaling-book/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script crossorigin="anonymous" defer="" id="MathJax-script" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" type="text/javascript"></script> <script src="https://jax-ml.github.io/scaling-book/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script crossorigin="anonymous" defer="" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script defer="" src="https://jax-ml.github.io/scaling-book/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="https://jax-ml.github.io/scaling-book/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script><div class="hidden" id="back-to-top"><svg viewbox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg></div> <div class="hiddendiv common"></div></body>
</html>